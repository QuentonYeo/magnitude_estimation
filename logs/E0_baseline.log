2025-11-03 13:40:19,885 | seisbench | WARNING | Setting remote root to: https://seisbench.gfz.de/mirror/
Please note that this can affect your download speed.
2025-11-03 13:40:30,516 | seisbench | WARNING | Output component order not specified, defaulting to 'ZNE'.
2025-11-03 13:40:36,468 | seisbench | WARNING | Skipping preload, as cache is disabled.
2025-11-03 13:40:41,543 | seisbench | WARNING | Skipping preload, as cache is disabled.
/home/quenton.yeo/code/.venv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:60: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(

==================================================
LOADING DATA
==================================================
STEAD dataset loaded: 1265657 samples

Training umamba_mag_v2 on STEAD for 150 epochs...
Model moved to cuda:0
Training UMamba V2 Magnitude Estimator model (encoder-only with pooling)

============================================================
TRAINING UMAMBAMAG V2 (ENCODER-ONLY WITH POOLING)
============================================================
Model: UMambaMag_v2_STEAD
Dataset: STEAD
Batch size: 32
Learning rate: 0.001
Epochs: 150
Warmup epochs: 5
============================================================
Model is on device: cuda:0
Total parameters: 191,313
Trainable parameters: 191,313

Loading data...
Train batches: 33619
Dev batches: 1978

Saving models to: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041


============================================================
Epoch 1/150
Learning Rate: 1.00e-04
============================================================

============================================================
Epoch 1 Summary:
  Train - Loss: 0.264449 | MSE: 0.264449 | RMSE: 0.514246 | MAE: 0.352362
  Val   - Loss: 0.170710 | MSE: 0.170710 | RMSE: 0.413171 | MAE: 0.277465
============================================================

✓ New best model saved! Val Loss: 0.170710

============================================================
Epoch 2/150
Learning Rate: 2.80e-04
============================================================

============================================================
Epoch 2 Summary:
  Train - Loss: 0.180754 | MSE: 0.180754 | RMSE: 0.425151 | MAE: 0.294386
  Val   - Loss: 0.135726 | MSE: 0.135726 | RMSE: 0.368410 | MAE: 0.246786
============================================================

✓ New best model saved! Val Loss: 0.135726

============================================================
Epoch 3/150
Learning Rate: 4.60e-04
============================================================

============================================================
Epoch 3 Summary:
  Train - Loss: 0.150662 | MSE: 0.150662 | RMSE: 0.388152 | MAE: 0.269218
  Val   - Loss: 0.121921 | MSE: 0.121921 | RMSE: 0.349172 | MAE: 0.241651
============================================================

✓ New best model saved! Val Loss: 0.121921

============================================================
Epoch 4/150
Learning Rate: 6.40e-04
============================================================

============================================================
Epoch 4 Summary:
  Train - Loss: 0.136759 | MSE: 0.136759 | RMSE: 0.369809 | MAE: 0.255582
  Val   - Loss: 0.115895 | MSE: 0.115895 | RMSE: 0.340434 | MAE: 0.224199
============================================================

✓ New best model saved! Val Loss: 0.115895

============================================================
Epoch 5/150
Learning Rate: 8.20e-04
============================================================

============================================================
Epoch 5 Summary:
  Train - Loss: 0.128341 | MSE: 0.128341 | RMSE: 0.358248 | MAE: 0.247952
  Val   - Loss: 0.116238 | MSE: 0.116238 | RMSE: 0.340937 | MAE: 0.228274
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_5.pt

============================================================
Epoch 6/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 6 Summary:
  Train - Loss: 0.122848 | MSE: 0.122848 | RMSE: 0.350497 | MAE: 0.242389
  Val   - Loss: 0.106573 | MSE: 0.106573 | RMSE: 0.326456 | MAE: 0.214678
============================================================

✓ New best model saved! Val Loss: 0.106573

============================================================
Epoch 7/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 7 Summary:
  Train - Loss: 0.115465 | MSE: 0.115465 | RMSE: 0.339801 | MAE: 0.235141
  Val   - Loss: 0.098301 | MSE: 0.098301 | RMSE: 0.313531 | MAE: 0.207603
============================================================

✓ New best model saved! Val Loss: 0.098301

============================================================
Epoch 8/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 8 Summary:
  Train - Loss: 0.110926 | MSE: 0.110926 | RMSE: 0.333055 | MAE: 0.230004
  Val   - Loss: 0.097951 | MSE: 0.097951 | RMSE: 0.312972 | MAE: 0.200400
============================================================

✓ New best model saved! Val Loss: 0.097951

============================================================
Epoch 9/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 9 Summary:
  Train - Loss: 0.106755 | MSE: 0.106755 | RMSE: 0.326734 | MAE: 0.225682
  Val   - Loss: 0.089359 | MSE: 0.089359 | RMSE: 0.298930 | MAE: 0.196961
============================================================

✓ New best model saved! Val Loss: 0.089359

============================================================
Epoch 10/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 10 Summary:
  Train - Loss: 0.103919 | MSE: 0.103919 | RMSE: 0.322365 | MAE: 0.222418
  Val   - Loss: 0.090636 | MSE: 0.090636 | RMSE: 0.301059 | MAE: 0.196099
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_10.pt

============================================================
Epoch 11/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 11 Summary:
  Train - Loss: 0.102010 | MSE: 0.102010 | RMSE: 0.319390 | MAE: 0.220322
  Val   - Loss: 0.088750 | MSE: 0.088750 | RMSE: 0.297909 | MAE: 0.199154
============================================================

✓ New best model saved! Val Loss: 0.088750

============================================================
Epoch 12/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 12 Summary:
  Train - Loss: 0.099868 | MSE: 0.099868 | RMSE: 0.316019 | MAE: 0.217798
  Val   - Loss: 0.086624 | MSE: 0.086624 | RMSE: 0.294320 | MAE: 0.189813
============================================================

✓ New best model saved! Val Loss: 0.086624

============================================================
Epoch 13/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 13 Summary:
  Train - Loss: 0.098065 | MSE: 0.098065 | RMSE: 0.313153 | MAE: 0.216162
  Val   - Loss: 0.085727 | MSE: 0.085727 | RMSE: 0.292792 | MAE: 0.193162
============================================================

✓ New best model saved! Val Loss: 0.085727

============================================================
Epoch 14/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 14 Summary:
  Train - Loss: 0.096913 | MSE: 0.096913 | RMSE: 0.311309 | MAE: 0.214677
  Val   - Loss: 0.084557 | MSE: 0.084557 | RMSE: 0.290786 | MAE: 0.193152
============================================================

✓ New best model saved! Val Loss: 0.084557

============================================================
Epoch 15/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 15 Summary:
  Train - Loss: 0.095682 | MSE: 0.095682 | RMSE: 0.309325 | MAE: 0.213275
  Val   - Loss: 0.083595 | MSE: 0.083595 | RMSE: 0.289129 | MAE: 0.191098
============================================================

✓ New best model saved! Val Loss: 0.083595
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_15.pt

============================================================
Epoch 16/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 16 Summary:
  Train - Loss: 0.094280 | MSE: 0.094280 | RMSE: 0.307050 | MAE: 0.211767
  Val   - Loss: 0.083281 | MSE: 0.083281 | RMSE: 0.288585 | MAE: 0.190191
============================================================

✓ New best model saved! Val Loss: 0.083281

============================================================
Epoch 17/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 17 Summary:
  Train - Loss: 0.093385 | MSE: 0.093385 | RMSE: 0.305590 | MAE: 0.210619
  Val   - Loss: 0.080694 | MSE: 0.080694 | RMSE: 0.284067 | MAE: 0.189626
============================================================

✓ New best model saved! Val Loss: 0.080694

============================================================
Epoch 18/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 18 Summary:
  Train - Loss: 0.092347 | MSE: 0.092347 | RMSE: 0.303886 | MAE: 0.209551
  Val   - Loss: 0.080775 | MSE: 0.080775 | RMSE: 0.284210 | MAE: 0.180763
============================================================
No improvement for 1 epochs

============================================================
Epoch 19/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 19 Summary:
  Train - Loss: 0.091466 | MSE: 0.091466 | RMSE: 0.302434 | MAE: 0.208610
  Val   - Loss: 0.079844 | MSE: 0.079844 | RMSE: 0.282567 | MAE: 0.189969
============================================================

✓ New best model saved! Val Loss: 0.079844

============================================================
Epoch 20/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 20 Summary:
  Train - Loss: 0.091590 | MSE: 0.091590 | RMSE: 0.302638 | MAE: 0.208391
  Val   - Loss: 0.079509 | MSE: 0.079509 | RMSE: 0.281974 | MAE: 0.188173
============================================================

✓ New best model saved! Val Loss: 0.079509
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_20.pt

============================================================
Epoch 21/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 21 Summary:
  Train - Loss: 0.090469 | MSE: 0.090469 | RMSE: 0.300781 | MAE: 0.207338
  Val   - Loss: 0.080798 | MSE: 0.080798 | RMSE: 0.284250 | MAE: 0.184710
============================================================
No improvement for 1 epochs

============================================================
Epoch 22/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 22 Summary:
  Train - Loss: 0.090436 | MSE: 0.090436 | RMSE: 0.300725 | MAE: 0.207074
  Val   - Loss: 0.079202 | MSE: 0.079202 | RMSE: 0.281429 | MAE: 0.187904
============================================================

✓ New best model saved! Val Loss: 0.079202

============================================================
Epoch 23/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 23 Summary:
  Train - Loss: 0.089240 | MSE: 0.089240 | RMSE: 0.298731 | MAE: 0.206005
  Val   - Loss: 0.079203 | MSE: 0.079203 | RMSE: 0.281430 | MAE: 0.186051
============================================================
No improvement for 1 epochs

============================================================
Epoch 24/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 24 Summary:
  Train - Loss: 0.088751 | MSE: 0.088751 | RMSE: 0.297912 | MAE: 0.205412
  Val   - Loss: 0.080022 | MSE: 0.080022 | RMSE: 0.282882 | MAE: 0.185195
============================================================
No improvement for 2 epochs

============================================================
Epoch 25/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 25 Summary:
  Train - Loss: 0.088474 | MSE: 0.088474 | RMSE: 0.297446 | MAE: 0.204876
  Val   - Loss: 0.076598 | MSE: 0.076598 | RMSE: 0.276764 | MAE: 0.179288
============================================================

✓ New best model saved! Val Loss: 0.076598
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_25.pt

============================================================
Epoch 26/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 26 Summary:
  Train - Loss: 0.087890 | MSE: 0.087890 | RMSE: 0.296462 | MAE: 0.204045
  Val   - Loss: 0.078120 | MSE: 0.078120 | RMSE: 0.279500 | MAE: 0.188743
============================================================
No improvement for 1 epochs

============================================================
Epoch 27/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 27 Summary:
  Train - Loss: 0.087701 | MSE: 0.087701 | RMSE: 0.296143 | MAE: 0.203820
  Val   - Loss: 0.078302 | MSE: 0.078302 | RMSE: 0.279825 | MAE: 0.180202
============================================================
No improvement for 2 epochs

============================================================
Epoch 28/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 28 Summary:
  Train - Loss: 0.087375 | MSE: 0.087375 | RMSE: 0.295593 | MAE: 0.203378
  Val   - Loss: 0.077484 | MSE: 0.077484 | RMSE: 0.278360 | MAE: 0.179216
============================================================
No improvement for 3 epochs

============================================================
Epoch 29/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 29 Summary:
  Train - Loss: 0.086566 | MSE: 0.086566 | RMSE: 0.294221 | MAE: 0.202651
  Val   - Loss: 0.079500 | MSE: 0.079500 | RMSE: 0.281958 | MAE: 0.181930
============================================================
No improvement for 4 epochs

============================================================
Epoch 30/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 30 Summary:
  Train - Loss: 0.086056 | MSE: 0.086056 | RMSE: 0.293353 | MAE: 0.202275
  Val   - Loss: 0.073868 | MSE: 0.073868 | RMSE: 0.271787 | MAE: 0.175307
============================================================

✓ New best model saved! Val Loss: 0.073868
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_30.pt

============================================================
Epoch 31/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 31 Summary:
  Train - Loss: 0.085832 | MSE: 0.085832 | RMSE: 0.292970 | MAE: 0.201742
  Val   - Loss: 0.076110 | MSE: 0.076110 | RMSE: 0.275881 | MAE: 0.176925
============================================================
No improvement for 1 epochs

============================================================
Epoch 32/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 32 Summary:
  Train - Loss: 0.085572 | MSE: 0.085572 | RMSE: 0.292527 | MAE: 0.201539
  Val   - Loss: 0.073356 | MSE: 0.073356 | RMSE: 0.270843 | MAE: 0.178017
============================================================

✓ New best model saved! Val Loss: 0.073356

============================================================
Epoch 33/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 33 Summary:
  Train - Loss: 0.085155 | MSE: 0.085155 | RMSE: 0.291814 | MAE: 0.201130
  Val   - Loss: 0.075913 | MSE: 0.075913 | RMSE: 0.275523 | MAE: 0.181308
============================================================
No improvement for 1 epochs

============================================================
Epoch 34/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 34 Summary:
  Train - Loss: 0.085309 | MSE: 0.085309 | RMSE: 0.292076 | MAE: 0.200908
  Val   - Loss: 0.072900 | MSE: 0.072900 | RMSE: 0.270000 | MAE: 0.174734
============================================================

✓ New best model saved! Val Loss: 0.072900

============================================================
Epoch 35/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 35 Summary:
  Train - Loss: 0.084937 | MSE: 0.084937 | RMSE: 0.291439 | MAE: 0.200825
  Val   - Loss: 0.074379 | MSE: 0.074379 | RMSE: 0.272724 | MAE: 0.175683
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_35.pt

============================================================
Epoch 36/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 36 Summary:
  Train - Loss: 0.084505 | MSE: 0.084505 | RMSE: 0.290697 | MAE: 0.200152
  Val   - Loss: 0.074790 | MSE: 0.074790 | RMSE: 0.273477 | MAE: 0.178636
============================================================
No improvement for 2 epochs

============================================================
Epoch 37/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 37 Summary:
  Train - Loss: 0.084019 | MSE: 0.084019 | RMSE: 0.289861 | MAE: 0.199762
  Val   - Loss: 0.074965 | MSE: 0.074965 | RMSE: 0.273797 | MAE: 0.181293
============================================================
No improvement for 3 epochs

============================================================
Epoch 38/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 38 Summary:
  Train - Loss: 0.084319 | MSE: 0.084319 | RMSE: 0.290377 | MAE: 0.199694
  Val   - Loss: 0.076572 | MSE: 0.076572 | RMSE: 0.276717 | MAE: 0.182545
============================================================
No improvement for 4 epochs

============================================================
Epoch 39/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 39 Summary:
  Train - Loss: 0.083373 | MSE: 0.083373 | RMSE: 0.288744 | MAE: 0.198928
  Val   - Loss: 0.075879 | MSE: 0.075879 | RMSE: 0.275461 | MAE: 0.185689
============================================================
No improvement for 5 epochs

============================================================
Epoch 40/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 40 Summary:
  Train - Loss: 0.083612 | MSE: 0.083612 | RMSE: 0.289158 | MAE: 0.199132
  Val   - Loss: 0.074607 | MSE: 0.074607 | RMSE: 0.273143 | MAE: 0.175518
============================================================
No improvement for 6 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_40.pt

============================================================
Epoch 41/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 41 Summary:
  Train - Loss: 0.077300 | MSE: 0.077300 | RMSE: 0.278030 | MAE: 0.191106
  Val   - Loss: 0.070306 | MSE: 0.070306 | RMSE: 0.265154 | MAE: 0.170770
============================================================

✓ New best model saved! Val Loss: 0.070306

============================================================
Epoch 42/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 42 Summary:
  Train - Loss: 0.082761 | MSE: 0.082761 | RMSE: 0.287682 | MAE: 0.198130
  Val   - Loss: 0.075302 | MSE: 0.075302 | RMSE: 0.274413 | MAE: 0.180482
============================================================
No improvement for 1 epochs

============================================================
Epoch 43/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 43 Summary:
  Train - Loss: 0.082874 | MSE: 0.082874 | RMSE: 0.287879 | MAE: 0.198248
  Val   - Loss: 0.075271 | MSE: 0.075271 | RMSE: 0.274356 | MAE: 0.175305
============================================================
No improvement for 2 epochs

============================================================
Epoch 44/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 44 Summary:
  Train - Loss: 0.082895 | MSE: 0.082895 | RMSE: 0.287914 | MAE: 0.198014
  Val   - Loss: 0.074779 | MSE: 0.074779 | RMSE: 0.273457 | MAE: 0.176035
============================================================
No improvement for 3 epochs

============================================================
Epoch 45/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 45 Summary:
  Train - Loss: 0.082532 | MSE: 0.082532 | RMSE: 0.287283 | MAE: 0.197877
  Val   - Loss: 0.074936 | MSE: 0.074936 | RMSE: 0.273745 | MAE: 0.178556
============================================================
No improvement for 4 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_45.pt

============================================================
Epoch 46/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 46 Summary:
  Train - Loss: 0.082290 | MSE: 0.082290 | RMSE: 0.286862 | MAE: 0.197536
  Val   - Loss: 0.075232 | MSE: 0.075232 | RMSE: 0.274284 | MAE: 0.178430
============================================================
No improvement for 5 epochs

============================================================
Epoch 47/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 47 Summary:
  Train - Loss: 0.081879 | MSE: 0.081879 | RMSE: 0.286145 | MAE: 0.197301
  Val   - Loss: 0.072438 | MSE: 0.072438 | RMSE: 0.269143 | MAE: 0.171350
============================================================
No improvement for 6 epochs

============================================================
Epoch 48/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 48 Summary:
  Train - Loss: 0.075896 | MSE: 0.075896 | RMSE: 0.275492 | MAE: 0.189312
  Val   - Loss: 0.069922 | MSE: 0.069922 | RMSE: 0.264427 | MAE: 0.173040
============================================================

✓ New best model saved! Val Loss: 0.069922

============================================================
Epoch 49/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 49 Summary:
  Train - Loss: 0.081682 | MSE: 0.081682 | RMSE: 0.285800 | MAE: 0.196757
  Val   - Loss: 0.071745 | MSE: 0.071745 | RMSE: 0.267853 | MAE: 0.173971
============================================================
No improvement for 1 epochs

============================================================
Epoch 50/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 50 Summary:
  Train - Loss: 0.081504 | MSE: 0.081504 | RMSE: 0.285489 | MAE: 0.196510
  Val   - Loss: 0.072788 | MSE: 0.072788 | RMSE: 0.269793 | MAE: 0.175827
============================================================
No improvement for 2 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_50.pt

============================================================
Epoch 51/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 51 Summary:
  Train - Loss: 0.081007 | MSE: 0.081007 | RMSE: 0.284617 | MAE: 0.196180
  Val   - Loss: 0.072077 | MSE: 0.072077 | RMSE: 0.268472 | MAE: 0.174384
============================================================
No improvement for 3 epochs

============================================================
Epoch 52/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 52 Summary:
  Train - Loss: 0.081059 | MSE: 0.081059 | RMSE: 0.284709 | MAE: 0.196269
  Val   - Loss: 0.073915 | MSE: 0.073915 | RMSE: 0.271873 | MAE: 0.174273
============================================================
No improvement for 4 epochs

============================================================
Epoch 53/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 53 Summary:
  Train - Loss: 0.081148 | MSE: 0.081148 | RMSE: 0.284865 | MAE: 0.196220
  Val   - Loss: 0.071239 | MSE: 0.071239 | RMSE: 0.266906 | MAE: 0.174972
============================================================
No improvement for 5 epochs

============================================================
Epoch 54/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 54 Summary:
  Train - Loss: 0.081086 | MSE: 0.081086 | RMSE: 0.284756 | MAE: 0.196248
  Val   - Loss: 0.071876 | MSE: 0.071876 | RMSE: 0.268096 | MAE: 0.173787
============================================================
No improvement for 6 epochs

============================================================
Epoch 55/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 55 Summary:
  Train - Loss: 0.074972 | MSE: 0.074972 | RMSE: 0.273810 | MAE: 0.188116
  Val   - Loss: 0.065502 | MSE: 0.065502 | RMSE: 0.255934 | MAE: 0.164550
============================================================

✓ New best model saved! Val Loss: 0.065502
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_55.pt

============================================================
Epoch 56/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 56 Summary:
  Train - Loss: 0.080517 | MSE: 0.080517 | RMSE: 0.283756 | MAE: 0.195434
  Val   - Loss: 0.073528 | MSE: 0.073528 | RMSE: 0.271160 | MAE: 0.180960
============================================================
No improvement for 1 epochs

============================================================
Epoch 57/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 57 Summary:
  Train - Loss: 0.080593 | MSE: 0.080593 | RMSE: 0.283889 | MAE: 0.195568
  Val   - Loss: 0.074243 | MSE: 0.074243 | RMSE: 0.272475 | MAE: 0.178092
============================================================
No improvement for 2 epochs

============================================================
Epoch 58/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 58 Summary:
  Train - Loss: 0.080425 | MSE: 0.080425 | RMSE: 0.283593 | MAE: 0.195203
  Val   - Loss: 0.071859 | MSE: 0.071859 | RMSE: 0.268065 | MAE: 0.173572
============================================================
No improvement for 3 epochs

============================================================
Epoch 59/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 59 Summary:
  Train - Loss: 0.079824 | MSE: 0.079824 | RMSE: 0.282531 | MAE: 0.194857
  Val   - Loss: 0.070819 | MSE: 0.070819 | RMSE: 0.266119 | MAE: 0.170760
============================================================
No improvement for 4 epochs

============================================================
Epoch 60/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 60 Summary:
  Train - Loss: 0.080015 | MSE: 0.080015 | RMSE: 0.282870 | MAE: 0.195038
  Val   - Loss: 0.072862 | MSE: 0.072862 | RMSE: 0.269930 | MAE: 0.172750
============================================================
No improvement for 5 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_60.pt

============================================================
Epoch 61/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 61 Summary:
  Train - Loss: 0.080005 | MSE: 0.080005 | RMSE: 0.282851 | MAE: 0.194761
  Val   - Loss: 0.071944 | MSE: 0.071944 | RMSE: 0.268223 | MAE: 0.174172
============================================================
No improvement for 6 epochs

============================================================
Epoch 62/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 62 Summary:
  Train - Loss: 0.074234 | MSE: 0.074234 | RMSE: 0.272460 | MAE: 0.187252
  Val   - Loss: 0.066847 | MSE: 0.066847 | RMSE: 0.258548 | MAE: 0.165712
============================================================
No improvement for 7 epochs

============================================================
Epoch 63/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 63 Summary:
  Train - Loss: 0.079273 | MSE: 0.079273 | RMSE: 0.281554 | MAE: 0.194112
  Val   - Loss: 0.075089 | MSE: 0.075089 | RMSE: 0.274023 | MAE: 0.180184
============================================================
No improvement for 8 epochs

============================================================
Epoch 64/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 64 Summary:
  Train - Loss: 0.079295 | MSE: 0.079295 | RMSE: 0.281593 | MAE: 0.194220
  Val   - Loss: 0.071953 | MSE: 0.071953 | RMSE: 0.268241 | MAE: 0.175031
============================================================
No improvement for 9 epochs

============================================================
Epoch 65/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 65 Summary:
  Train - Loss: 0.079578 | MSE: 0.079578 | RMSE: 0.282096 | MAE: 0.194428
  Val   - Loss: 0.071011 | MSE: 0.071011 | RMSE: 0.266479 | MAE: 0.172097
============================================================
No improvement for 10 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_epoch_65.pt

============================================================
Epoch 66/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 66 Summary:
  Train - Loss: 0.079310 | MSE: 0.079310 | RMSE: 0.281620 | MAE: 0.194041
  Val   - Loss: 0.071366 | MSE: 0.071366 | RMSE: 0.267145 | MAE: 0.175716
============================================================
No improvement for 11 epochs

============================================================
Epoch 67/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 67 Summary:
  Train - Loss: 0.079436 | MSE: 0.079436 | RMSE: 0.281843 | MAE: 0.194014
  Val   - Loss: 0.070322 | MSE: 0.070322 | RMSE: 0.265182 | MAE: 0.173424
============================================================
No improvement for 12 epochs

============================================================
Epoch 68/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 68 Summary:
  Train - Loss: 0.073674 | MSE: 0.073674 | RMSE: 0.271429 | MAE: 0.186517
  Val   - Loss: 0.068854 | MSE: 0.068854 | RMSE: 0.262401 | MAE: 0.172483
============================================================
No improvement for 13 epochs

============================================================
Epoch 69/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 69 Summary:
  Train - Loss: 0.078662 | MSE: 0.078662 | RMSE: 0.280467 | MAE: 0.193220
  Val   - Loss: 0.069201 | MSE: 0.069201 | RMSE: 0.263061 | MAE: 0.168987
============================================================
No improvement for 14 epochs

============================================================
Epoch 70/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 70 Summary:
  Train - Loss: 0.078823 | MSE: 0.078823 | RMSE: 0.280754 | MAE: 0.193489
  Val   - Loss: 0.072273 | MSE: 0.072273 | RMSE: 0.268836 | MAE: 0.171993
============================================================
No improvement for 15 epochs

Early stopping triggered after 15 epochs without improvement
Best validation loss: 0.065502

Final model saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/model_final.pt
Training history saved: src/trained_weights/UMambaMag_v2_STEAD_20251103_134041/training_history_20251103_134041.pt

============================================================
TRAINING COMPLETED
============================================================
Best validation loss: 0.065502
Best validation RMSE: 0.255934
Final train loss: 0.078823
Final val loss: 0.072273
Total Training Time: 12:30:44
============================================================
==================================================


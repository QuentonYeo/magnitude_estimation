2025-11-05 16:27:23,423 | seisbench | WARNING | Setting remote root to: https://seisbench.gfz.de/mirror/
Please note that this can affect your download speed.
2025-11-05 16:27:33,418 | seisbench | WARNING | Output component order not specified, defaulting to 'ZNE'.
2025-11-05 16:27:39,364 | seisbench | WARNING | Skipping preload, as cache is disabled.
2025-11-05 16:27:44,357 | seisbench | WARNING | Skipping preload, as cache is disabled.
/home/quenton.yeo/code/.venv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:60: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(

==================================================
LOADING DATA
==================================================
STEAD dataset loaded: 1265657 samples

Training umamba_mag_v2 on STEAD for 150 epochs...
Model moved to cuda:0
Training UMamba V2 Magnitude Estimator model (encoder-only with pooling)

============================================================
TRAINING UMAMBAMAG V2 (ENCODER-ONLY WITH POOLING)
============================================================
Model: UMambaMag_v2_STEAD
Dataset: STEAD
Batch size: 24
Learning rate: 0.001
Epochs: 150
Warmup epochs: 5
============================================================
Model is on device: cuda:0
Total parameters: 405,721
Trainable parameters: 405,721

Loading data...
Train batches: 44826
Dev batches: 2637

Saving models to: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744


============================================================
Epoch 1/150
Learning Rate: 1.00e-04
============================================================

============================================================
Epoch 1 Summary:
  Train - Loss: 0.241406 | MSE: 0.241406 | RMSE: 0.491331 | MAE: 0.332179
  Val   - Loss: 0.151500 | MSE: 0.151500 | RMSE: 0.389230 | MAE: 0.262243
============================================================

✓ New best model saved! Val Loss: 0.151500

============================================================
Epoch 2/150
Learning Rate: 2.80e-04
============================================================

============================================================
Epoch 2 Summary:
  Train - Loss: 0.164169 | MSE: 0.164169 | RMSE: 0.405177 | MAE: 0.279107
  Val   - Loss: 0.123655 | MSE: 0.123655 | RMSE: 0.351646 | MAE: 0.235234
============================================================

✓ New best model saved! Val Loss: 0.123655

============================================================
Epoch 3/150
Learning Rate: 4.60e-04
============================================================

============================================================
Epoch 3 Summary:
  Train - Loss: 0.139245 | MSE: 0.139245 | RMSE: 0.373156 | MAE: 0.257190
  Val   - Loss: 0.118347 | MSE: 0.118347 | RMSE: 0.344016 | MAE: 0.226232
============================================================

✓ New best model saved! Val Loss: 0.118347

============================================================
Epoch 4/150
Learning Rate: 6.40e-04
============================================================

============================================================
Epoch 4 Summary:
  Train - Loss: 0.128413 | MSE: 0.128413 | RMSE: 0.358348 | MAE: 0.246537
  Val   - Loss: 0.106474 | MSE: 0.106474 | RMSE: 0.326303 | MAE: 0.214957
============================================================

✓ New best model saved! Val Loss: 0.106474

============================================================
Epoch 5/150
Learning Rate: 8.20e-04
============================================================

============================================================
Epoch 5 Summary:
  Train - Loss: 0.121938 | MSE: 0.121938 | RMSE: 0.349196 | MAE: 0.240715
  Val   - Loss: 0.104212 | MSE: 0.104212 | RMSE: 0.322819 | MAE: 0.212115
============================================================

✓ New best model saved! Val Loss: 0.104212
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_5.pt

============================================================
Epoch 6/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 6 Summary:
  Train - Loss: 0.118379 | MSE: 0.118379 | RMSE: 0.344062 | MAE: 0.237511
  Val   - Loss: 0.104258 | MSE: 0.104258 | RMSE: 0.322890 | MAE: 0.211608
============================================================
No improvement for 1 epochs

============================================================
Epoch 7/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 7 Summary:
  Train - Loss: 0.112212 | MSE: 0.112212 | RMSE: 0.334981 | MAE: 0.231194
  Val   - Loss: 0.103995 | MSE: 0.103995 | RMSE: 0.322483 | MAE: 0.210814
============================================================

✓ New best model saved! Val Loss: 0.103995

============================================================
Epoch 8/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 8 Summary:
  Train - Loss: 0.107987 | MSE: 0.107987 | RMSE: 0.328613 | MAE: 0.226596
  Val   - Loss: 0.095795 | MSE: 0.095795 | RMSE: 0.309508 | MAE: 0.203219
============================================================

✓ New best model saved! Val Loss: 0.095795

============================================================
Epoch 9/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 9 Summary:
  Train - Loss: 0.104110 | MSE: 0.104110 | RMSE: 0.322661 | MAE: 0.222789
  Val   - Loss: 0.095221 | MSE: 0.095221 | RMSE: 0.308579 | MAE: 0.202953
============================================================

✓ New best model saved! Val Loss: 0.095221

============================================================
Epoch 10/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 10 Summary:
  Train - Loss: 0.101713 | MSE: 0.101713 | RMSE: 0.318925 | MAE: 0.219647
  Val   - Loss: 0.084060 | MSE: 0.084060 | RMSE: 0.289931 | MAE: 0.187995
============================================================

✓ New best model saved! Val Loss: 0.084060
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_10.pt

============================================================
Epoch 11/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 11 Summary:
  Train - Loss: 0.099335 | MSE: 0.099335 | RMSE: 0.315175 | MAE: 0.217073
  Val   - Loss: 0.086939 | MSE: 0.086939 | RMSE: 0.294855 | MAE: 0.197034
============================================================
No improvement for 1 epochs

============================================================
Epoch 12/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 12 Summary:
  Train - Loss: 0.097639 | MSE: 0.097639 | RMSE: 0.312472 | MAE: 0.215035
  Val   - Loss: 0.083816 | MSE: 0.083816 | RMSE: 0.289510 | MAE: 0.190056
============================================================

✓ New best model saved! Val Loss: 0.083816

============================================================
Epoch 13/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 13 Summary:
  Train - Loss: 0.096537 | MSE: 0.096537 | RMSE: 0.310704 | MAE: 0.213619
  Val   - Loss: 0.083184 | MSE: 0.083184 | RMSE: 0.288416 | MAE: 0.191026
============================================================

✓ New best model saved! Val Loss: 0.083184

============================================================
Epoch 14/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 14 Summary:
  Train - Loss: 0.094925 | MSE: 0.094925 | RMSE: 0.308098 | MAE: 0.212065
  Val   - Loss: 0.082514 | MSE: 0.082514 | RMSE: 0.287252 | MAE: 0.185985
============================================================

✓ New best model saved! Val Loss: 0.082514

============================================================
Epoch 15/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 15 Summary:
  Train - Loss: 0.093641 | MSE: 0.093641 | RMSE: 0.306009 | MAE: 0.210569
  Val   - Loss: 0.082983 | MSE: 0.082983 | RMSE: 0.288067 | MAE: 0.196278
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_15.pt

============================================================
Epoch 16/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 16 Summary:
  Train - Loss: 0.092258 | MSE: 0.092258 | RMSE: 0.303739 | MAE: 0.209139
  Val   - Loss: 0.078645 | MSE: 0.078645 | RMSE: 0.280437 | MAE: 0.180047
============================================================

✓ New best model saved! Val Loss: 0.078645

============================================================
Epoch 17/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 17 Summary:
  Train - Loss: 0.091392 | MSE: 0.091392 | RMSE: 0.302312 | MAE: 0.208042
  Val   - Loss: 0.084994 | MSE: 0.084994 | RMSE: 0.291537 | MAE: 0.189217
============================================================
No improvement for 1 epochs

============================================================
Epoch 18/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 18 Summary:
  Train - Loss: 0.090967 | MSE: 0.090967 | RMSE: 0.301608 | MAE: 0.207277
  Val   - Loss: 0.081525 | MSE: 0.081525 | RMSE: 0.285525 | MAE: 0.183584
============================================================
No improvement for 2 epochs

============================================================
Epoch 19/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 19 Summary:
  Train - Loss: 0.090132 | MSE: 0.090132 | RMSE: 0.300219 | MAE: 0.206521
  Val   - Loss: 0.076482 | MSE: 0.076482 | RMSE: 0.276554 | MAE: 0.181418
============================================================

✓ New best model saved! Val Loss: 0.076482

============================================================
Epoch 20/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 20 Summary:
  Train - Loss: 0.089271 | MSE: 0.089271 | RMSE: 0.298783 | MAE: 0.205424
  Val   - Loss: 0.077190 | MSE: 0.077190 | RMSE: 0.277831 | MAE: 0.185036
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_20.pt

============================================================
Epoch 21/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 21 Summary:
  Train - Loss: 0.088203 | MSE: 0.088203 | RMSE: 0.296991 | MAE: 0.204462
  Val   - Loss: 0.079623 | MSE: 0.079623 | RMSE: 0.282176 | MAE: 0.187522
============================================================
No improvement for 2 epochs

============================================================
Epoch 22/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 22 Summary:
  Train - Loss: 0.087763 | MSE: 0.087763 | RMSE: 0.296249 | MAE: 0.203754
  Val   - Loss: 0.078475 | MSE: 0.078475 | RMSE: 0.280135 | MAE: 0.180562
============================================================
No improvement for 3 epochs

============================================================
Epoch 23/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 23 Summary:
  Train - Loss: 0.087111 | MSE: 0.087111 | RMSE: 0.295146 | MAE: 0.202820
  Val   - Loss: 0.075801 | MSE: 0.075801 | RMSE: 0.275319 | MAE: 0.177030
============================================================

✓ New best model saved! Val Loss: 0.075801

============================================================
Epoch 24/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 24 Summary:
  Train - Loss: 0.086912 | MSE: 0.086912 | RMSE: 0.294808 | MAE: 0.202455
  Val   - Loss: 0.076295 | MSE: 0.076295 | RMSE: 0.276215 | MAE: 0.178550
============================================================
No improvement for 1 epochs

============================================================
Epoch 25/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 25 Summary:
  Train - Loss: 0.085745 | MSE: 0.085745 | RMSE: 0.292823 | MAE: 0.201232
  Val   - Loss: 0.074511 | MSE: 0.074511 | RMSE: 0.272967 | MAE: 0.175707
============================================================

✓ New best model saved! Val Loss: 0.074511
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_25.pt

============================================================
Epoch 26/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 26 Summary:
  Train - Loss: 0.085556 | MSE: 0.085556 | RMSE: 0.292500 | MAE: 0.200937
  Val   - Loss: 0.075986 | MSE: 0.075986 | RMSE: 0.275655 | MAE: 0.179028
============================================================
No improvement for 1 epochs

============================================================
Epoch 27/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 27 Summary:
  Train - Loss: 0.085056 | MSE: 0.085056 | RMSE: 0.291644 | MAE: 0.200354
  Val   - Loss: 0.073739 | MSE: 0.073739 | RMSE: 0.271550 | MAE: 0.173893
============================================================

✓ New best model saved! Val Loss: 0.073739

============================================================
Epoch 28/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 28 Summary:
  Train - Loss: 0.085250 | MSE: 0.085250 | RMSE: 0.291975 | MAE: 0.200071
  Val   - Loss: 0.075301 | MSE: 0.075301 | RMSE: 0.274411 | MAE: 0.181748
============================================================
No improvement for 1 epochs

============================================================
Epoch 29/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 29 Summary:
  Train - Loss: 0.084041 | MSE: 0.084041 | RMSE: 0.289898 | MAE: 0.199426
  Val   - Loss: 0.074964 | MSE: 0.074964 | RMSE: 0.273795 | MAE: 0.178007
============================================================
No improvement for 2 epochs

============================================================
Epoch 30/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 30 Summary:
  Train - Loss: 0.083527 | MSE: 0.083527 | RMSE: 0.289011 | MAE: 0.199062
  Val   - Loss: 0.073365 | MSE: 0.073365 | RMSE: 0.270861 | MAE: 0.177930
============================================================

✓ New best model saved! Val Loss: 0.073365
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_30.pt

============================================================
Epoch 31/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 31 Summary:
  Train - Loss: 0.083771 | MSE: 0.083771 | RMSE: 0.289432 | MAE: 0.198494
  Val   - Loss: 0.075486 | MSE: 0.075486 | RMSE: 0.274748 | MAE: 0.179104
============================================================
No improvement for 1 epochs

============================================================
Epoch 32/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 32 Summary:
  Train - Loss: 0.083035 | MSE: 0.083035 | RMSE: 0.288158 | MAE: 0.198057
  Val   - Loss: 0.072875 | MSE: 0.072875 | RMSE: 0.269953 | MAE: 0.183414
============================================================

✓ New best model saved! Val Loss: 0.072875

============================================================
Epoch 33/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 33 Summary:
  Train - Loss: 0.082695 | MSE: 0.082695 | RMSE: 0.287567 | MAE: 0.197673
  Val   - Loss: 0.073092 | MSE: 0.073092 | RMSE: 0.270355 | MAE: 0.177111
============================================================
No improvement for 1 epochs

============================================================
Epoch 34/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 34 Summary:
  Train - Loss: 0.082330 | MSE: 0.082330 | RMSE: 0.286932 | MAE: 0.197335
  Val   - Loss: 0.070758 | MSE: 0.070758 | RMSE: 0.266003 | MAE: 0.167935
============================================================

✓ New best model saved! Val Loss: 0.070758

============================================================
Epoch 35/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 35 Summary:
  Train - Loss: 0.081847 | MSE: 0.081847 | RMSE: 0.286090 | MAE: 0.196633
  Val   - Loss: 0.074798 | MSE: 0.074798 | RMSE: 0.273492 | MAE: 0.175302
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_35.pt

============================================================
Epoch 36/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 36 Summary:
  Train - Loss: 0.081826 | MSE: 0.081826 | RMSE: 0.286053 | MAE: 0.196440
  Val   - Loss: 0.073120 | MSE: 0.073120 | RMSE: 0.270408 | MAE: 0.173537
============================================================
No improvement for 2 epochs

============================================================
Epoch 37/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 37 Summary:
  Train - Loss: 0.081315 | MSE: 0.081315 | RMSE: 0.285158 | MAE: 0.196415
  Val   - Loss: 0.072693 | MSE: 0.072693 | RMSE: 0.269616 | MAE: 0.172225
============================================================
No improvement for 3 epochs

============================================================
Epoch 38/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 38 Summary:
  Train - Loss: 0.081144 | MSE: 0.081144 | RMSE: 0.284859 | MAE: 0.195604
  Val   - Loss: 0.070086 | MSE: 0.070086 | RMSE: 0.264738 | MAE: 0.169825
============================================================

✓ New best model saved! Val Loss: 0.070086

============================================================
Epoch 39/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 39 Summary:
  Train - Loss: 0.080978 | MSE: 0.080978 | RMSE: 0.284566 | MAE: 0.195507
  Val   - Loss: 0.070093 | MSE: 0.070093 | RMSE: 0.264750 | MAE: 0.174222
============================================================
No improvement for 1 epochs

============================================================
Epoch 40/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 40 Summary:
  Train - Loss: 0.080683 | MSE: 0.080683 | RMSE: 0.284047 | MAE: 0.195118
  Val   - Loss: 0.068896 | MSE: 0.068896 | RMSE: 0.262481 | MAE: 0.168900
============================================================

✓ New best model saved! Val Loss: 0.068896
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_40.pt

============================================================
Epoch 41/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 41 Summary:
  Train - Loss: 0.080367 | MSE: 0.080367 | RMSE: 0.283491 | MAE: 0.194988
  Val   - Loss: 0.069978 | MSE: 0.069978 | RMSE: 0.264533 | MAE: 0.171533
============================================================
No improvement for 1 epochs

============================================================
Epoch 42/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 42 Summary:
  Train - Loss: 0.079882 | MSE: 0.079882 | RMSE: 0.282633 | MAE: 0.194440
  Val   - Loss: 0.070231 | MSE: 0.070231 | RMSE: 0.265010 | MAE: 0.168567
============================================================
No improvement for 2 epochs

============================================================
Epoch 43/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 43 Summary:
  Train - Loss: 0.080080 | MSE: 0.080080 | RMSE: 0.282985 | MAE: 0.194292
  Val   - Loss: 0.073340 | MSE: 0.073340 | RMSE: 0.270814 | MAE: 0.179059
============================================================
No improvement for 3 epochs

============================================================
Epoch 44/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 44 Summary:
  Train - Loss: 0.079457 | MSE: 0.079457 | RMSE: 0.281881 | MAE: 0.193932
  Val   - Loss: 0.072146 | MSE: 0.072146 | RMSE: 0.268599 | MAE: 0.171158
============================================================
No improvement for 4 epochs

============================================================
Epoch 45/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 45 Summary:
  Train - Loss: 0.078951 | MSE: 0.078951 | RMSE: 0.280983 | MAE: 0.193102
  Val   - Loss: 0.067521 | MSE: 0.067521 | RMSE: 0.259848 | MAE: 0.174139
============================================================

✓ New best model saved! Val Loss: 0.067521
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_45.pt

============================================================
Epoch 46/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 46 Summary:
  Train - Loss: 0.078952 | MSE: 0.078952 | RMSE: 0.280983 | MAE: 0.193092
  Val   - Loss: 0.077077 | MSE: 0.077077 | RMSE: 0.277628 | MAE: 0.180207
============================================================
No improvement for 1 epochs

============================================================
Epoch 47/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 47 Summary:
  Train - Loss: 0.079110 | MSE: 0.079110 | RMSE: 0.281264 | MAE: 0.193155
  Val   - Loss: 0.068358 | MSE: 0.068358 | RMSE: 0.261453 | MAE: 0.172084
============================================================
No improvement for 2 epochs

============================================================
Epoch 48/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 48 Summary:
  Train - Loss: 0.078512 | MSE: 0.078512 | RMSE: 0.280201 | MAE: 0.192716
  Val   - Loss: 0.071891 | MSE: 0.071891 | RMSE: 0.268125 | MAE: 0.173615
============================================================
No improvement for 3 epochs

============================================================
Epoch 49/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 49 Summary:
  Train - Loss: 0.078301 | MSE: 0.078301 | RMSE: 0.279823 | MAE: 0.192519
  Val   - Loss: 0.068923 | MSE: 0.068923 | RMSE: 0.262532 | MAE: 0.176030
============================================================
No improvement for 4 epochs

============================================================
Epoch 50/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 50 Summary:
  Train - Loss: 0.078668 | MSE: 0.078668 | RMSE: 0.280478 | MAE: 0.192169
  Val   - Loss: 0.069928 | MSE: 0.069928 | RMSE: 0.264439 | MAE: 0.169556
============================================================
No improvement for 5 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_50.pt

============================================================
Epoch 51/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 51 Summary:
  Train - Loss: 0.078069 | MSE: 0.078069 | RMSE: 0.279408 | MAE: 0.191815
  Val   - Loss: 0.069012 | MSE: 0.069012 | RMSE: 0.262702 | MAE: 0.165896
============================================================
No improvement for 6 epochs

============================================================
Epoch 52/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 52 Summary:
  Train - Loss: 0.071422 | MSE: 0.071422 | RMSE: 0.267248 | MAE: 0.183345
  Val   - Loss: 0.064377 | MSE: 0.064377 | RMSE: 0.253726 | MAE: 0.164587
============================================================

✓ New best model saved! Val Loss: 0.064377

============================================================
Epoch 53/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 53 Summary:
  Train - Loss: 0.077067 | MSE: 0.077067 | RMSE: 0.277610 | MAE: 0.190940
  Val   - Loss: 0.080244 | MSE: 0.080244 | RMSE: 0.283274 | MAE: 0.188054
============================================================
No improvement for 1 epochs

============================================================
Epoch 54/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 54 Summary:
  Train - Loss: 0.077503 | MSE: 0.077503 | RMSE: 0.278394 | MAE: 0.191200
  Val   - Loss: 0.071344 | MSE: 0.071344 | RMSE: 0.267103 | MAE: 0.175149
============================================================
No improvement for 2 epochs

============================================================
Epoch 55/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 55 Summary:
  Train - Loss: 0.077209 | MSE: 0.077209 | RMSE: 0.277864 | MAE: 0.191084
  Val   - Loss: 0.070043 | MSE: 0.070043 | RMSE: 0.264657 | MAE: 0.170630
============================================================
No improvement for 3 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_55.pt

============================================================
Epoch 56/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 56 Summary:
  Train - Loss: 0.076733 | MSE: 0.076733 | RMSE: 0.277008 | MAE: 0.190627
  Val   - Loss: 0.067278 | MSE: 0.067278 | RMSE: 0.259379 | MAE: 0.166195
============================================================
No improvement for 4 epochs

============================================================
Epoch 57/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 57 Summary:
  Train - Loss: 0.076990 | MSE: 0.076990 | RMSE: 0.277471 | MAE: 0.190599
  Val   - Loss: 0.073198 | MSE: 0.073198 | RMSE: 0.270551 | MAE: 0.183788
============================================================
No improvement for 5 epochs

============================================================
Epoch 58/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 58 Summary:
  Train - Loss: 0.076599 | MSE: 0.076599 | RMSE: 0.276765 | MAE: 0.190404
  Val   - Loss: 0.070593 | MSE: 0.070593 | RMSE: 0.265693 | MAE: 0.170148
============================================================
No improvement for 6 epochs

============================================================
Epoch 59/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 59 Summary:
  Train - Loss: 0.070213 | MSE: 0.070213 | RMSE: 0.264978 | MAE: 0.181705
  Val   - Loss: 0.062203 | MSE: 0.062203 | RMSE: 0.249406 | MAE: 0.164560
============================================================

✓ New best model saved! Val Loss: 0.062203

============================================================
Epoch 60/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 60 Summary:
  Train - Loss: 0.075786 | MSE: 0.075786 | RMSE: 0.275293 | MAE: 0.189268
  Val   - Loss: 0.065397 | MSE: 0.065397 | RMSE: 0.255729 | MAE: 0.165382
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_60.pt

============================================================
Epoch 61/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 61 Summary:
  Train - Loss: 0.076081 | MSE: 0.076081 | RMSE: 0.275827 | MAE: 0.189792
  Val   - Loss: 0.072524 | MSE: 0.072524 | RMSE: 0.269302 | MAE: 0.179664
============================================================
No improvement for 2 epochs

============================================================
Epoch 62/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 62 Summary:
  Train - Loss: 0.076200 | MSE: 0.076200 | RMSE: 0.276043 | MAE: 0.189774
  Val   - Loss: 0.067725 | MSE: 0.067725 | RMSE: 0.260241 | MAE: 0.167228
============================================================
No improvement for 3 epochs

============================================================
Epoch 63/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 63 Summary:
  Train - Loss: 0.075774 | MSE: 0.075774 | RMSE: 0.275270 | MAE: 0.189489
  Val   - Loss: 0.067677 | MSE: 0.067677 | RMSE: 0.260147 | MAE: 0.166578
============================================================
No improvement for 4 epochs

============================================================
Epoch 64/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 64 Summary:
  Train - Loss: 0.076183 | MSE: 0.076183 | RMSE: 0.276013 | MAE: 0.189523
  Val   - Loss: 0.066376 | MSE: 0.066376 | RMSE: 0.257636 | MAE: 0.167560
============================================================
No improvement for 5 epochs

============================================================
Epoch 65/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 65 Summary:
  Train - Loss: 0.075408 | MSE: 0.075408 | RMSE: 0.274606 | MAE: 0.188944
  Val   - Loss: 0.067880 | MSE: 0.067880 | RMSE: 0.260537 | MAE: 0.171613
============================================================
No improvement for 6 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_65.pt

============================================================
Epoch 66/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 66 Summary:
  Train - Loss: 0.069161 | MSE: 0.069161 | RMSE: 0.262985 | MAE: 0.180456
  Val   - Loss: 0.065481 | MSE: 0.065481 | RMSE: 0.255892 | MAE: 0.159457
============================================================
No improvement for 7 epochs

============================================================
Epoch 67/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 67 Summary:
  Train - Loss: 0.074839 | MSE: 0.074839 | RMSE: 0.273567 | MAE: 0.188164
  Val   - Loss: 0.069101 | MSE: 0.069101 | RMSE: 0.262871 | MAE: 0.166589
============================================================
No improvement for 8 epochs

============================================================
Epoch 68/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 68 Summary:
  Train - Loss: 0.075070 | MSE: 0.075070 | RMSE: 0.273989 | MAE: 0.188535
  Val   - Loss: 0.067674 | MSE: 0.067674 | RMSE: 0.260142 | MAE: 0.171908
============================================================
No improvement for 9 epochs

============================================================
Epoch 69/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 69 Summary:
  Train - Loss: 0.074882 | MSE: 0.074882 | RMSE: 0.273647 | MAE: 0.188207
  Val   - Loss: 0.069144 | MSE: 0.069144 | RMSE: 0.262953 | MAE: 0.173785
============================================================
No improvement for 10 epochs

============================================================
Epoch 70/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 70 Summary:
  Train - Loss: 0.074866 | MSE: 0.074866 | RMSE: 0.273617 | MAE: 0.188310
  Val   - Loss: 0.067098 | MSE: 0.067098 | RMSE: 0.259032 | MAE: 0.164208
============================================================
No improvement for 11 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_70.pt

============================================================
Epoch 71/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 71 Summary:
  Train - Loss: 0.074653 | MSE: 0.074653 | RMSE: 0.273227 | MAE: 0.187993
  Val   - Loss: 0.066453 | MSE: 0.066453 | RMSE: 0.257784 | MAE: 0.164166
============================================================
No improvement for 12 epochs

============================================================
Epoch 72/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 72 Summary:
  Train - Loss: 0.068450 | MSE: 0.068450 | RMSE: 0.261630 | MAE: 0.179522
  Val   - Loss: 0.061486 | MSE: 0.061486 | RMSE: 0.247963 | MAE: 0.158462
============================================================

✓ New best model saved! Val Loss: 0.061486

============================================================
Epoch 73/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 73 Summary:
  Train - Loss: 0.074059 | MSE: 0.074059 | RMSE: 0.272138 | MAE: 0.187208
  Val   - Loss: 0.066709 | MSE: 0.066709 | RMSE: 0.258281 | MAE: 0.164940
============================================================
No improvement for 1 epochs

============================================================
Epoch 74/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 74 Summary:
  Train - Loss: 0.074335 | MSE: 0.074335 | RMSE: 0.272645 | MAE: 0.187471
  Val   - Loss: 0.066137 | MSE: 0.066137 | RMSE: 0.257171 | MAE: 0.166047
============================================================
No improvement for 2 epochs

============================================================
Epoch 75/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 75 Summary:
  Train - Loss: 0.074052 | MSE: 0.074052 | RMSE: 0.272125 | MAE: 0.187279
  Val   - Loss: 0.069407 | MSE: 0.069407 | RMSE: 0.263453 | MAE: 0.172496
============================================================
No improvement for 3 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_75.pt

============================================================
Epoch 76/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 76 Summary:
  Train - Loss: 0.073932 | MSE: 0.073932 | RMSE: 0.271905 | MAE: 0.187169
  Val   - Loss: 0.070121 | MSE: 0.070121 | RMSE: 0.264803 | MAE: 0.181440
============================================================
No improvement for 4 epochs

============================================================
Epoch 77/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 77 Summary:
  Train - Loss: 0.074008 | MSE: 0.074008 | RMSE: 0.272045 | MAE: 0.187226
  Val   - Loss: 0.068965 | MSE: 0.068965 | RMSE: 0.262612 | MAE: 0.167685
============================================================
No improvement for 5 epochs

============================================================
Epoch 78/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 78 Summary:
  Train - Loss: 0.073952 | MSE: 0.073952 | RMSE: 0.271941 | MAE: 0.187266
  Val   - Loss: 0.067076 | MSE: 0.067076 | RMSE: 0.258991 | MAE: 0.168021
============================================================
No improvement for 6 epochs

============================================================
Epoch 79/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 79 Summary:
  Train - Loss: 0.067800 | MSE: 0.067800 | RMSE: 0.260384 | MAE: 0.178662
  Val   - Loss: 0.061733 | MSE: 0.061733 | RMSE: 0.248461 | MAE: 0.157782
============================================================
No improvement for 7 epochs

============================================================
Epoch 80/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 80 Summary:
  Train - Loss: 0.073260 | MSE: 0.073260 | RMSE: 0.270666 | MAE: 0.186278
  Val   - Loss: 0.065534 | MSE: 0.065534 | RMSE: 0.255995 | MAE: 0.169802
============================================================
No improvement for 8 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_80.pt

============================================================
Epoch 81/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 81 Summary:
  Train - Loss: 0.073447 | MSE: 0.073447 | RMSE: 0.271010 | MAE: 0.186360
  Val   - Loss: 0.067093 | MSE: 0.067093 | RMSE: 0.259024 | MAE: 0.164180
============================================================
No improvement for 9 epochs

============================================================
Epoch 82/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 82 Summary:
  Train - Loss: 0.073397 | MSE: 0.073397 | RMSE: 0.270918 | MAE: 0.186314
  Val   - Loss: 0.067206 | MSE: 0.067206 | RMSE: 0.259242 | MAE: 0.166683
============================================================
No improvement for 10 epochs

============================================================
Epoch 83/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 83 Summary:
  Train - Loss: 0.073604 | MSE: 0.073604 | RMSE: 0.271300 | MAE: 0.186339
  Val   - Loss: 0.066028 | MSE: 0.066028 | RMSE: 0.256960 | MAE: 0.163820
============================================================
No improvement for 11 epochs

============================================================
Epoch 84/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 84 Summary:
  Train - Loss: 0.073245 | MSE: 0.073245 | RMSE: 0.270638 | MAE: 0.186245
  Val   - Loss: 0.068672 | MSE: 0.068672 | RMSE: 0.262053 | MAE: 0.168695
============================================================
No improvement for 12 epochs

============================================================
Epoch 85/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 85 Summary:
  Train - Loss: 0.066887 | MSE: 0.066887 | RMSE: 0.258626 | MAE: 0.177690
  Val   - Loss: 0.060391 | MSE: 0.060391 | RMSE: 0.245746 | MAE: 0.157246
============================================================

✓ New best model saved! Val Loss: 0.060391
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_85.pt

============================================================
Epoch 86/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 86 Summary:
  Train - Loss: 0.072812 | MSE: 0.072812 | RMSE: 0.269837 | MAE: 0.185382
  Val   - Loss: 0.067957 | MSE: 0.067957 | RMSE: 0.260686 | MAE: 0.166341
============================================================
No improvement for 1 epochs

============================================================
Epoch 87/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 87 Summary:
  Train - Loss: 0.072846 | MSE: 0.072846 | RMSE: 0.269899 | MAE: 0.185752
  Val   - Loss: 0.065339 | MSE: 0.065339 | RMSE: 0.255615 | MAE: 0.162521
============================================================
No improvement for 2 epochs

============================================================
Epoch 88/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 88 Summary:
  Train - Loss: 0.072607 | MSE: 0.072607 | RMSE: 0.269457 | MAE: 0.185664
  Val   - Loss: 0.064090 | MSE: 0.064090 | RMSE: 0.253161 | MAE: 0.161856
============================================================
No improvement for 3 epochs

============================================================
Epoch 89/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 89 Summary:
  Train - Loss: 0.072628 | MSE: 0.072628 | RMSE: 0.269495 | MAE: 0.185623
  Val   - Loss: 0.066390 | MSE: 0.066390 | RMSE: 0.257662 | MAE: 0.170451
============================================================
No improvement for 4 epochs

============================================================
Epoch 90/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 90 Summary:
  Train - Loss: 0.072998 | MSE: 0.072998 | RMSE: 0.270181 | MAE: 0.185548
  Val   - Loss: 0.066405 | MSE: 0.066405 | RMSE: 0.257691 | MAE: 0.167594
============================================================
No improvement for 5 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_90.pt

============================================================
Epoch 91/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 91 Summary:
  Train - Loss: 0.072625 | MSE: 0.072625 | RMSE: 0.269491 | MAE: 0.185340
  Val   - Loss: 0.067015 | MSE: 0.067015 | RMSE: 0.258872 | MAE: 0.163967
============================================================
No improvement for 6 epochs

============================================================
Epoch 92/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 92 Summary:
  Train - Loss: 0.066355 | MSE: 0.066355 | RMSE: 0.257594 | MAE: 0.176852
  Val   - Loss: 0.061823 | MSE: 0.061823 | RMSE: 0.248643 | MAE: 0.158890
============================================================
No improvement for 7 epochs

============================================================
Epoch 93/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 93 Summary:
  Train - Loss: 0.071767 | MSE: 0.071767 | RMSE: 0.267894 | MAE: 0.184590
  Val   - Loss: 0.063775 | MSE: 0.063775 | RMSE: 0.252537 | MAE: 0.161500
============================================================
No improvement for 8 epochs

============================================================
Epoch 94/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 94 Summary:
  Train - Loss: 0.072222 | MSE: 0.072222 | RMSE: 0.268742 | MAE: 0.185041
  Val   - Loss: 0.067495 | MSE: 0.067495 | RMSE: 0.259798 | MAE: 0.174054
============================================================
No improvement for 9 epochs

============================================================
Epoch 95/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 95 Summary:
  Train - Loss: 0.072356 | MSE: 0.072356 | RMSE: 0.268990 | MAE: 0.184940
  Val   - Loss: 0.066396 | MSE: 0.066396 | RMSE: 0.257674 | MAE: 0.162100
============================================================
No improvement for 10 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_epoch_95.pt

============================================================
Epoch 96/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 96 Summary:
  Train - Loss: 0.071614 | MSE: 0.071614 | RMSE: 0.267609 | MAE: 0.184482
  Val   - Loss: 0.065474 | MSE: 0.065474 | RMSE: 0.255878 | MAE: 0.163451
============================================================
No improvement for 11 epochs

============================================================
Epoch 97/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 97 Summary:
  Train - Loss: 0.072183 | MSE: 0.072183 | RMSE: 0.268669 | MAE: 0.184953
  Val   - Loss: 0.065216 | MSE: 0.065216 | RMSE: 0.255375 | MAE: 0.162892
============================================================
No improvement for 12 epochs

============================================================
Epoch 98/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 98 Summary:
  Train - Loss: 0.065812 | MSE: 0.065812 | RMSE: 0.256539 | MAE: 0.176233
  Val   - Loss: 0.060420 | MSE: 0.060420 | RMSE: 0.245804 | MAE: 0.158985
============================================================
No improvement for 13 epochs

============================================================
Epoch 99/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 99 Summary:
  Train - Loss: 0.070965 | MSE: 0.070965 | RMSE: 0.266393 | MAE: 0.183887
  Val   - Loss: 0.064458 | MSE: 0.064458 | RMSE: 0.253887 | MAE: 0.175304
============================================================
No improvement for 14 epochs

============================================================
Epoch 100/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 100 Summary:
  Train - Loss: 0.071610 | MSE: 0.071610 | RMSE: 0.267601 | MAE: 0.184265
  Val   - Loss: 0.063166 | MSE: 0.063166 | RMSE: 0.251329 | MAE: 0.160503
============================================================
No improvement for 15 epochs

Early stopping triggered after 15 epochs without improvement
Best validation loss: 0.060391

Final model saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/model_final.pt
Training history saved: src/trained_weights/UMambaMag_v2_STEAD_20251105_162744/training_history_20251105_162744.pt

============================================================
TRAINING COMPLETED
============================================================
Best validation loss: 0.060391
Best validation RMSE: 0.245746
Final train loss: 0.071610
Final val loss: 0.063166
Total Training Time: 27:17:24
============================================================
==================================================


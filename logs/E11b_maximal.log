2025-11-16 14:53:03,344 | seisbench | WARNING | Setting remote root to: https://seisbench.gfz.de/mirror/
Please note that this can affect your download speed.
2025-11-16 14:53:13,299 | seisbench | WARNING | Output component order not specified, defaulting to 'ZNE'.
2025-11-16 14:53:19,436 | seisbench | WARNING | Skipping preload, as cache is disabled.
2025-11-16 14:53:24,468 | seisbench | WARNING | Skipping preload, as cache is disabled.
/home/quenton.yeo/code/.venv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:60: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(

==================================================
LOADING DATA
==================================================
STEAD dataset loaded: 1265657 samples

Training umamba_mag_v2 on STEAD for 150 epochs...
Model moved to cuda:3
Training UMamba V2 Magnitude Estimator model (encoder-only with pooling)

============================================================
TRAINING UMAMBAMAG V2 (ENCODER-ONLY WITH POOLING)
============================================================
Model: UMambaMag_v2_STEAD
Dataset: STEAD
Batch size: 32
Learning rate: 0.001
Epochs: 150
Warmup epochs: 5
============================================================
Model is on device: cuda:3
Total parameters: 1,537,921
Trainable parameters: 1,537,921

Loading data...
Train batches: 33619
Dev batches: 1978

Saving models to: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324


============================================================
Epoch 1/150
Learning Rate: 2.00e-04
============================================================

============================================================
Epoch 1 Summary:
  Train - Loss: 0.268401 | MSE: 0.268401 | RMSE: 0.518074 | MAE: 0.348560
  Val   - Loss: 0.176730 | MSE: 0.176730 | RMSE: 0.420393 | MAE: 0.279147
============================================================

✓ New best model saved! Val Loss: 0.176730

============================================================
Epoch 2/150
Learning Rate: 4.00e-04
============================================================

============================================================
Epoch 2 Summary:
  Train - Loss: 0.184597 | MSE: 0.184597 | RMSE: 0.429648 | MAE: 0.291189
  Val   - Loss: 0.139659 | MSE: 0.139659 | RMSE: 0.373710 | MAE: 0.248009
============================================================

✓ New best model saved! Val Loss: 0.139659

============================================================
Epoch 3/150
Learning Rate: 6.00e-04
============================================================

============================================================
Epoch 3 Summary:
  Train - Loss: 0.158780 | MSE: 0.158780 | RMSE: 0.398471 | MAE: 0.269752
  Val   - Loss: 0.128654 | MSE: 0.128654 | RMSE: 0.358684 | MAE: 0.232319
============================================================

✓ New best model saved! Val Loss: 0.128654

============================================================
Epoch 4/150
Learning Rate: 8.00e-04
============================================================

============================================================
Epoch 4 Summary:
  Train - Loss: 0.146043 | MSE: 0.146043 | RMSE: 0.382156 | MAE: 0.259537
  Val   - Loss: 0.124073 | MSE: 0.124073 | RMSE: 0.352240 | MAE: 0.228989
============================================================

✓ New best model saved! Val Loss: 0.124073

============================================================
Epoch 5/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 5 Summary:
  Train - Loss: 0.139181 | MSE: 0.139181 | RMSE: 0.373070 | MAE: 0.253852
  Val   - Loss: 0.123358 | MSE: 0.123358 | RMSE: 0.351224 | MAE: 0.226197
============================================================

✓ New best model saved! Val Loss: 0.123358
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_5.pt

============================================================
Epoch 6/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 6 Summary:
  Train - Loss: 0.128686 | MSE: 0.128686 | RMSE: 0.358728 | MAE: 0.244480
  Val   - Loss: 0.112716 | MSE: 0.112716 | RMSE: 0.335732 | MAE: 0.222063
============================================================

✓ New best model saved! Val Loss: 0.112716

============================================================
Epoch 7/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 7 Summary:
  Train - Loss: 0.122144 | MSE: 0.122144 | RMSE: 0.349492 | MAE: 0.237976
  Val   - Loss: 0.106486 | MSE: 0.106486 | RMSE: 0.326322 | MAE: 0.213427
============================================================

✓ New best model saved! Val Loss: 0.106486

============================================================
Epoch 8/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 8 Summary:
  Train - Loss: 0.117297 | MSE: 0.117297 | RMSE: 0.342487 | MAE: 0.232970
  Val   - Loss: 0.103951 | MSE: 0.103951 | RMSE: 0.322415 | MAE: 0.206341
============================================================

✓ New best model saved! Val Loss: 0.103951

============================================================
Epoch 9/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 9 Summary:
  Train - Loss: 0.113734 | MSE: 0.113734 | RMSE: 0.337244 | MAE: 0.229568
  Val   - Loss: 0.102554 | MSE: 0.102554 | RMSE: 0.320241 | MAE: 0.210022
============================================================

✓ New best model saved! Val Loss: 0.102554

============================================================
Epoch 10/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 10 Summary:
  Train - Loss: 0.110998 | MSE: 0.110998 | RMSE: 0.333164 | MAE: 0.226855
  Val   - Loss: 0.096947 | MSE: 0.096947 | RMSE: 0.311363 | MAE: 0.201399
============================================================

✓ New best model saved! Val Loss: 0.096947
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_10.pt

============================================================
Epoch 11/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 11 Summary:
  Train - Loss: 0.108615 | MSE: 0.108615 | RMSE: 0.329567 | MAE: 0.224169
  Val   - Loss: 0.094744 | MSE: 0.094744 | RMSE: 0.307806 | MAE: 0.200581
============================================================

✓ New best model saved! Val Loss: 0.094744

============================================================
Epoch 12/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 12 Summary:
  Train - Loss: 0.106437 | MSE: 0.106437 | RMSE: 0.326246 | MAE: 0.221967
  Val   - Loss: 0.099781 | MSE: 0.099781 | RMSE: 0.315882 | MAE: 0.204365
============================================================
No improvement for 1 epochs

============================================================
Epoch 13/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 13 Summary:
  Train - Loss: 0.104708 | MSE: 0.104708 | RMSE: 0.323587 | MAE: 0.220403
  Val   - Loss: 0.093656 | MSE: 0.093656 | RMSE: 0.306033 | MAE: 0.200073
============================================================

✓ New best model saved! Val Loss: 0.093656

============================================================
Epoch 14/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 14 Summary:
  Train - Loss: 0.102940 | MSE: 0.102940 | RMSE: 0.320843 | MAE: 0.218438
  Val   - Loss: 0.091455 | MSE: 0.091455 | RMSE: 0.302415 | MAE: 0.191734
============================================================

✓ New best model saved! Val Loss: 0.091455

============================================================
Epoch 15/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 15 Summary:
  Train - Loss: 0.101374 | MSE: 0.101374 | RMSE: 0.318392 | MAE: 0.216809
  Val   - Loss: 0.093394 | MSE: 0.093394 | RMSE: 0.305604 | MAE: 0.198977
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_15.pt

============================================================
Epoch 16/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 16 Summary:
  Train - Loss: 0.099908 | MSE: 0.099908 | RMSE: 0.316083 | MAE: 0.215299
  Val   - Loss: 0.087677 | MSE: 0.087677 | RMSE: 0.296103 | MAE: 0.190259
============================================================

✓ New best model saved! Val Loss: 0.087677

============================================================
Epoch 17/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 17 Summary:
  Train - Loss: 0.098471 | MSE: 0.098471 | RMSE: 0.313801 | MAE: 0.214084
  Val   - Loss: 0.089143 | MSE: 0.089143 | RMSE: 0.298568 | MAE: 0.190158
============================================================
No improvement for 1 epochs

============================================================
Epoch 18/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 18 Summary:
  Train - Loss: 0.097627 | MSE: 0.097627 | RMSE: 0.312453 | MAE: 0.213213
  Val   - Loss: 0.085718 | MSE: 0.085718 | RMSE: 0.292776 | MAE: 0.197094
============================================================

✓ New best model saved! Val Loss: 0.085718

============================================================
Epoch 19/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 19 Summary:
  Train - Loss: 0.096760 | MSE: 0.096760 | RMSE: 0.311063 | MAE: 0.211768
  Val   - Loss: 0.087620 | MSE: 0.087620 | RMSE: 0.296007 | MAE: 0.193572
============================================================
No improvement for 1 epochs

============================================================
Epoch 20/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 20 Summary:
  Train - Loss: 0.095606 | MSE: 0.095606 | RMSE: 0.309202 | MAE: 0.210821
  Val   - Loss: 0.085670 | MSE: 0.085670 | RMSE: 0.292694 | MAE: 0.190212
============================================================

✓ New best model saved! Val Loss: 0.085670
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_20.pt

============================================================
Epoch 21/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 21 Summary:
  Train - Loss: 0.094729 | MSE: 0.094729 | RMSE: 0.307780 | MAE: 0.209801
  Val   - Loss: 0.088826 | MSE: 0.088826 | RMSE: 0.298037 | MAE: 0.191373
============================================================
No improvement for 1 epochs

============================================================
Epoch 22/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 22 Summary:
  Train - Loss: 0.093608 | MSE: 0.093608 | RMSE: 0.305954 | MAE: 0.209070
  Val   - Loss: 0.083209 | MSE: 0.083209 | RMSE: 0.288459 | MAE: 0.192788
============================================================

✓ New best model saved! Val Loss: 0.083209

============================================================
Epoch 23/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 23 Summary:
  Train - Loss: 0.092962 | MSE: 0.092962 | RMSE: 0.304897 | MAE: 0.208034
  Val   - Loss: 0.083938 | MSE: 0.083938 | RMSE: 0.289720 | MAE: 0.183246
============================================================
No improvement for 1 epochs

============================================================
Epoch 24/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 24 Summary:
  Train - Loss: 0.092590 | MSE: 0.092590 | RMSE: 0.304285 | MAE: 0.207489
  Val   - Loss: 0.085523 | MSE: 0.085523 | RMSE: 0.292444 | MAE: 0.186340
============================================================
No improvement for 2 epochs

============================================================
Epoch 25/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 25 Summary:
  Train - Loss: 0.091458 | MSE: 0.091458 | RMSE: 0.302420 | MAE: 0.206651
  Val   - Loss: 0.082687 | MSE: 0.082687 | RMSE: 0.287553 | MAE: 0.193342
============================================================

✓ New best model saved! Val Loss: 0.082687
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_25.pt

============================================================
Epoch 26/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 26 Summary:
  Train - Loss: 0.090816 | MSE: 0.090816 | RMSE: 0.301357 | MAE: 0.205718
  Val   - Loss: 0.080813 | MSE: 0.080813 | RMSE: 0.284276 | MAE: 0.186112
============================================================

✓ New best model saved! Val Loss: 0.080813

============================================================
Epoch 27/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 27 Summary:
  Train - Loss: 0.090063 | MSE: 0.090063 | RMSE: 0.300106 | MAE: 0.205235
  Val   - Loss: 0.085293 | MSE: 0.085293 | RMSE: 0.292050 | MAE: 0.191543
============================================================
No improvement for 1 epochs

============================================================
Epoch 28/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 28 Summary:
  Train - Loss: 0.089918 | MSE: 0.089918 | RMSE: 0.299863 | MAE: 0.204771
  Val   - Loss: 0.079457 | MSE: 0.079457 | RMSE: 0.281880 | MAE: 0.181136
============================================================

✓ New best model saved! Val Loss: 0.079457

============================================================
Epoch 29/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 29 Summary:
  Train - Loss: 0.088436 | MSE: 0.088436 | RMSE: 0.297381 | MAE: 0.203416
  Val   - Loss: 0.081991 | MSE: 0.081991 | RMSE: 0.286340 | MAE: 0.191183
============================================================
No improvement for 1 epochs

============================================================
Epoch 30/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 30 Summary:
  Train - Loss: 0.088186 | MSE: 0.088186 | RMSE: 0.296961 | MAE: 0.203300
  Val   - Loss: 0.083247 | MSE: 0.083247 | RMSE: 0.288525 | MAE: 0.181273
============================================================
No improvement for 2 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_30.pt

============================================================
Epoch 31/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 31 Summary:
  Train - Loss: 0.088221 | MSE: 0.088221 | RMSE: 0.297020 | MAE: 0.202720
  Val   - Loss: 0.082277 | MSE: 0.082277 | RMSE: 0.286839 | MAE: 0.187798
============================================================
No improvement for 3 epochs

============================================================
Epoch 32/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 32 Summary:
  Train - Loss: 0.087134 | MSE: 0.087134 | RMSE: 0.295184 | MAE: 0.201918
  Val   - Loss: 0.083621 | MSE: 0.083621 | RMSE: 0.289173 | MAE: 0.194019
============================================================
No improvement for 4 epochs

============================================================
Epoch 33/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 33 Summary:
  Train - Loss: 0.086447 | MSE: 0.086447 | RMSE: 0.294018 | MAE: 0.201551
  Val   - Loss: 0.081131 | MSE: 0.081131 | RMSE: 0.284835 | MAE: 0.180848
============================================================
No improvement for 5 epochs

============================================================
Epoch 34/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 34 Summary:
  Train - Loss: 0.086147 | MSE: 0.086147 | RMSE: 0.293508 | MAE: 0.200922
  Val   - Loss: 0.083867 | MSE: 0.083867 | RMSE: 0.289598 | MAE: 0.195812
============================================================
No improvement for 6 epochs

============================================================
Epoch 35/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 35 Summary:
  Train - Loss: 0.077104 | MSE: 0.077104 | RMSE: 0.277676 | MAE: 0.190252
  Val   - Loss: 0.073407 | MSE: 0.073407 | RMSE: 0.270937 | MAE: 0.171254
============================================================

✓ New best model saved! Val Loss: 0.073407
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_35.pt

============================================================
Epoch 36/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 36 Summary:
  Train - Loss: 0.075625 | MSE: 0.075625 | RMSE: 0.275000 | MAE: 0.188760
  Val   - Loss: 0.072997 | MSE: 0.072997 | RMSE: 0.270180 | MAE: 0.172440
============================================================

✓ New best model saved! Val Loss: 0.072997

============================================================
Epoch 37/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 37 Summary:
  Train - Loss: 0.074465 | MSE: 0.074465 | RMSE: 0.272883 | MAE: 0.187553
  Val   - Loss: 0.073008 | MSE: 0.073008 | RMSE: 0.270200 | MAE: 0.171832
============================================================
No improvement for 1 epochs

============================================================
Epoch 38/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 38 Summary:
  Train - Loss: 0.074033 | MSE: 0.074033 | RMSE: 0.272089 | MAE: 0.186934
  Val   - Loss: 0.072108 | MSE: 0.072108 | RMSE: 0.268530 | MAE: 0.168929
============================================================

✓ New best model saved! Val Loss: 0.072108

============================================================
Epoch 39/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 39 Summary:
  Train - Loss: 0.073454 | MSE: 0.073454 | RMSE: 0.271025 | MAE: 0.186101
  Val   - Loss: 0.072588 | MSE: 0.072588 | RMSE: 0.269421 | MAE: 0.169932
============================================================
No improvement for 1 epochs

============================================================
Epoch 40/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 40 Summary:
  Train - Loss: 0.072640 | MSE: 0.072640 | RMSE: 0.269518 | MAE: 0.185421
  Val   - Loss: 0.070023 | MSE: 0.070023 | RMSE: 0.264618 | MAE: 0.169634
============================================================

✓ New best model saved! Val Loss: 0.070023
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_40.pt

============================================================
Epoch 41/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 41 Summary:
  Train - Loss: 0.072204 | MSE: 0.072204 | RMSE: 0.268708 | MAE: 0.184888
  Val   - Loss: 0.071921 | MSE: 0.071921 | RMSE: 0.268182 | MAE: 0.176535
============================================================
No improvement for 1 epochs

============================================================
Epoch 42/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 42 Summary:
  Train - Loss: 0.071464 | MSE: 0.071464 | RMSE: 0.267328 | MAE: 0.184255
  Val   - Loss: 0.070631 | MSE: 0.070631 | RMSE: 0.265764 | MAE: 0.167898
============================================================
No improvement for 2 epochs

============================================================
Epoch 43/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 43 Summary:
  Train - Loss: 0.071383 | MSE: 0.071383 | RMSE: 0.267176 | MAE: 0.183951
  Val   - Loss: 0.071753 | MSE: 0.071753 | RMSE: 0.267868 | MAE: 0.168577
============================================================
No improvement for 3 epochs

============================================================
Epoch 44/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 44 Summary:
  Train - Loss: 0.070860 | MSE: 0.070860 | RMSE: 0.266196 | MAE: 0.183617
  Val   - Loss: 0.071086 | MSE: 0.071086 | RMSE: 0.266619 | MAE: 0.168744
============================================================
No improvement for 4 epochs

============================================================
Epoch 45/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 45 Summary:
  Train - Loss: 0.070615 | MSE: 0.070615 | RMSE: 0.265735 | MAE: 0.182883
  Val   - Loss: 0.070860 | MSE: 0.070860 | RMSE: 0.266196 | MAE: 0.168451
============================================================
No improvement for 5 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_45.pt

============================================================
Epoch 46/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 46 Summary:
  Train - Loss: 0.070189 | MSE: 0.070189 | RMSE: 0.264933 | MAE: 0.182636
  Val   - Loss: 0.071296 | MSE: 0.071296 | RMSE: 0.267014 | MAE: 0.169135
============================================================
No improvement for 6 epochs

============================================================
Epoch 47/150
Learning Rate: 2.50e-04
============================================================

============================================================
Epoch 47 Summary:
  Train - Loss: 0.065417 | MSE: 0.065417 | RMSE: 0.255768 | MAE: 0.176676
  Val   - Loss: 0.066580 | MSE: 0.066580 | RMSE: 0.258030 | MAE: 0.164413
============================================================

✓ New best model saved! Val Loss: 0.066580

============================================================
Epoch 48/150
Learning Rate: 2.50e-04
============================================================

============================================================
Epoch 48 Summary:
  Train - Loss: 0.064411 | MSE: 0.064411 | RMSE: 0.253793 | MAE: 0.175464
  Val   - Loss: 0.068780 | MSE: 0.068780 | RMSE: 0.262260 | MAE: 0.167324
============================================================
No improvement for 1 epochs

============================================================
Epoch 49/150
Learning Rate: 2.50e-04
============================================================

============================================================
Epoch 49 Summary:
  Train - Loss: 0.064241 | MSE: 0.064241 | RMSE: 0.253457 | MAE: 0.175118
  Val   - Loss: 0.069115 | MSE: 0.069115 | RMSE: 0.262898 | MAE: 0.169421
============================================================
No improvement for 2 epochs

============================================================
Epoch 50/150
Learning Rate: 2.50e-04
============================================================

============================================================
Epoch 50 Summary:
  Train - Loss: 0.063747 | MSE: 0.063747 | RMSE: 0.252481 | MAE: 0.174620
  Val   - Loss: 0.068398 | MSE: 0.068398 | RMSE: 0.261529 | MAE: 0.168461
============================================================
No improvement for 3 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_50.pt

============================================================
Epoch 51/150
Learning Rate: 2.50e-04
============================================================

============================================================
Epoch 51 Summary:
  Train - Loss: 0.063438 | MSE: 0.063438 | RMSE: 0.251869 | MAE: 0.174146
  Val   - Loss: 0.069215 | MSE: 0.069215 | RMSE: 0.263087 | MAE: 0.168678
============================================================
No improvement for 4 epochs

============================================================
Epoch 52/150
Learning Rate: 2.50e-04
============================================================

============================================================
Epoch 52 Summary:
  Train - Loss: 0.062714 | MSE: 0.062714 | RMSE: 0.250428 | MAE: 0.173689
  Val   - Loss: 0.068108 | MSE: 0.068108 | RMSE: 0.260975 | MAE: 0.164938
============================================================
No improvement for 5 epochs

============================================================
Epoch 53/150
Learning Rate: 2.50e-04
============================================================

============================================================
Epoch 53 Summary:
  Train - Loss: 0.062423 | MSE: 0.062423 | RMSE: 0.249846 | MAE: 0.173071
  Val   - Loss: 0.069849 | MSE: 0.069849 | RMSE: 0.264289 | MAE: 0.165200
============================================================
No improvement for 6 epochs

============================================================
Epoch 54/150
Learning Rate: 1.25e-04
============================================================

============================================================
Epoch 54 Summary:
  Train - Loss: 0.060523 | MSE: 0.060523 | RMSE: 0.246015 | MAE: 0.170212
  Val   - Loss: 0.066549 | MSE: 0.066549 | RMSE: 0.257970 | MAE: 0.163960
============================================================

✓ New best model saved! Val Loss: 0.066549

============================================================
Epoch 55/150
Learning Rate: 1.25e-04
============================================================

============================================================
Epoch 55 Summary:
  Train - Loss: 0.059707 | MSE: 0.059707 | RMSE: 0.244350 | MAE: 0.169579
  Val   - Loss: 0.067246 | MSE: 0.067246 | RMSE: 0.259319 | MAE: 0.163712
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_55.pt

============================================================
Epoch 56/150
Learning Rate: 1.25e-04
============================================================

============================================================
Epoch 56 Summary:
  Train - Loss: 0.059449 | MSE: 0.059449 | RMSE: 0.243821 | MAE: 0.169326
  Val   - Loss: 0.065963 | MSE: 0.065963 | RMSE: 0.256832 | MAE: 0.160823
============================================================

✓ New best model saved! Val Loss: 0.065963

============================================================
Epoch 57/150
Learning Rate: 1.25e-04
============================================================

============================================================
Epoch 57 Summary:
  Train - Loss: 0.059216 | MSE: 0.059216 | RMSE: 0.243344 | MAE: 0.169014
  Val   - Loss: 0.066553 | MSE: 0.066553 | RMSE: 0.257978 | MAE: 0.161811
============================================================
No improvement for 1 epochs

============================================================
Epoch 58/150
Learning Rate: 1.25e-04
============================================================

============================================================
Epoch 58 Summary:
  Train - Loss: 0.058843 | MSE: 0.058843 | RMSE: 0.242575 | MAE: 0.168628
  Val   - Loss: 0.067550 | MSE: 0.067550 | RMSE: 0.259904 | MAE: 0.163800
============================================================
No improvement for 2 epochs

============================================================
Epoch 59/150
Learning Rate: 1.25e-04
============================================================

============================================================
Epoch 59 Summary:
  Train - Loss: 0.058593 | MSE: 0.058593 | RMSE: 0.242060 | MAE: 0.168297
  Val   - Loss: 0.066880 | MSE: 0.066880 | RMSE: 0.258612 | MAE: 0.160960
============================================================
No improvement for 3 epochs

============================================================
Epoch 60/150
Learning Rate: 1.25e-04
============================================================

============================================================
Epoch 60 Summary:
  Train - Loss: 0.058501 | MSE: 0.058501 | RMSE: 0.241871 | MAE: 0.168224
  Val   - Loss: 0.067008 | MSE: 0.067008 | RMSE: 0.258859 | MAE: 0.166526
============================================================
No improvement for 4 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_60.pt

============================================================
Epoch 61/150
Learning Rate: 1.25e-04
============================================================

============================================================
Epoch 61 Summary:
  Train - Loss: 0.058216 | MSE: 0.058216 | RMSE: 0.241281 | MAE: 0.167930
  Val   - Loss: 0.066910 | MSE: 0.066910 | RMSE: 0.258670 | MAE: 0.162075
============================================================
No improvement for 5 epochs

============================================================
Epoch 62/150
Learning Rate: 1.25e-04
============================================================

============================================================
Epoch 62 Summary:
  Train - Loss: 0.058204 | MSE: 0.058204 | RMSE: 0.241255 | MAE: 0.167850
  Val   - Loss: 0.066837 | MSE: 0.066837 | RMSE: 0.258529 | MAE: 0.164355
============================================================
No improvement for 6 epochs

============================================================
Epoch 63/150
Learning Rate: 6.25e-05
============================================================

============================================================
Epoch 63 Summary:
  Train - Loss: 0.056998 | MSE: 0.056998 | RMSE: 0.238743 | MAE: 0.166171
  Val   - Loss: 0.065789 | MSE: 0.065789 | RMSE: 0.256493 | MAE: 0.161565
============================================================

✓ New best model saved! Val Loss: 0.065789

============================================================
Epoch 64/150
Learning Rate: 6.25e-05
============================================================

============================================================
Epoch 64 Summary:
  Train - Loss: 0.056994 | MSE: 0.056994 | RMSE: 0.238734 | MAE: 0.165876
  Val   - Loss: 0.066330 | MSE: 0.066330 | RMSE: 0.257546 | MAE: 0.160944
============================================================
No improvement for 1 epochs

============================================================
Epoch 65/150
Learning Rate: 6.25e-05
============================================================

============================================================
Epoch 65 Summary:
  Train - Loss: 0.056444 | MSE: 0.056444 | RMSE: 0.237580 | MAE: 0.165597
  Val   - Loss: 0.066887 | MSE: 0.066887 | RMSE: 0.258625 | MAE: 0.161176
============================================================
No improvement for 2 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_65.pt

============================================================
Epoch 66/150
Learning Rate: 6.25e-05
============================================================

============================================================
Epoch 66 Summary:
  Train - Loss: 0.056532 | MSE: 0.056532 | RMSE: 0.237765 | MAE: 0.165644
  Val   - Loss: 0.067074 | MSE: 0.067074 | RMSE: 0.258987 | MAE: 0.161348
============================================================
No improvement for 3 epochs

============================================================
Epoch 67/150
Learning Rate: 6.25e-05
============================================================

============================================================
Epoch 67 Summary:
  Train - Loss: 0.056446 | MSE: 0.056446 | RMSE: 0.237583 | MAE: 0.165433
  Val   - Loss: 0.066427 | MSE: 0.066427 | RMSE: 0.257734 | MAE: 0.160147
============================================================
No improvement for 4 epochs

============================================================
Epoch 68/150
Learning Rate: 6.25e-05
============================================================

============================================================
Epoch 68 Summary:
  Train - Loss: 0.056384 | MSE: 0.056384 | RMSE: 0.237453 | MAE: 0.165172
  Val   - Loss: 0.066798 | MSE: 0.066798 | RMSE: 0.258452 | MAE: 0.160961
============================================================
No improvement for 5 epochs

============================================================
Epoch 69/150
Learning Rate: 6.25e-05
============================================================

============================================================
Epoch 69 Summary:
  Train - Loss: 0.056108 | MSE: 0.056108 | RMSE: 0.236872 | MAE: 0.165057
  Val   - Loss: 0.066472 | MSE: 0.066472 | RMSE: 0.257822 | MAE: 0.162188
============================================================
No improvement for 6 epochs

============================================================
Epoch 70/150
Learning Rate: 3.13e-05
============================================================

============================================================
Epoch 70 Summary:
  Train - Loss: 0.055348 | MSE: 0.055348 | RMSE: 0.235262 | MAE: 0.164116
  Val   - Loss: 0.066663 | MSE: 0.066663 | RMSE: 0.258193 | MAE: 0.161100
============================================================
No improvement for 7 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_70.pt

============================================================
Epoch 71/150
Learning Rate: 3.13e-05
============================================================

============================================================
Epoch 71 Summary:
  Train - Loss: 0.055612 | MSE: 0.055612 | RMSE: 0.235821 | MAE: 0.164231
  Val   - Loss: 0.067401 | MSE: 0.067401 | RMSE: 0.259616 | MAE: 0.162008
============================================================
No improvement for 8 epochs

============================================================
Epoch 72/150
Learning Rate: 3.13e-05
============================================================

============================================================
Epoch 72 Summary:
  Train - Loss: 0.055144 | MSE: 0.055144 | RMSE: 0.234827 | MAE: 0.163892
  Val   - Loss: 0.065576 | MSE: 0.065576 | RMSE: 0.256078 | MAE: 0.159837
============================================================

✓ New best model saved! Val Loss: 0.065576

============================================================
Epoch 73/150
Learning Rate: 3.13e-05
============================================================

============================================================
Epoch 73 Summary:
  Train - Loss: 0.055499 | MSE: 0.055499 | RMSE: 0.235582 | MAE: 0.164114
  Val   - Loss: 0.067009 | MSE: 0.067009 | RMSE: 0.258861 | MAE: 0.161509
============================================================
No improvement for 1 epochs

============================================================
Epoch 74/150
Learning Rate: 3.13e-05
============================================================

============================================================
Epoch 74 Summary:
  Train - Loss: 0.055022 | MSE: 0.055022 | RMSE: 0.234568 | MAE: 0.163802
  Val   - Loss: 0.066242 | MSE: 0.066242 | RMSE: 0.257375 | MAE: 0.160334
============================================================
No improvement for 2 epochs

============================================================
Epoch 75/150
Learning Rate: 3.13e-05
============================================================

============================================================
Epoch 75 Summary:
  Train - Loss: 0.054838 | MSE: 0.054838 | RMSE: 0.234175 | MAE: 0.163584
  Val   - Loss: 0.067308 | MSE: 0.067308 | RMSE: 0.259439 | MAE: 0.160582
============================================================
No improvement for 3 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_75.pt

============================================================
Epoch 76/150
Learning Rate: 3.13e-05
============================================================

============================================================
Epoch 76 Summary:
  Train - Loss: 0.054909 | MSE: 0.054909 | RMSE: 0.234327 | MAE: 0.163601
  Val   - Loss: 0.066463 | MSE: 0.066463 | RMSE: 0.257803 | MAE: 0.160945
============================================================
No improvement for 4 epochs

============================================================
Epoch 77/150
Learning Rate: 3.13e-05
============================================================

============================================================
Epoch 77 Summary:
  Train - Loss: 0.055128 | MSE: 0.055128 | RMSE: 0.234793 | MAE: 0.163575
  Val   - Loss: 0.066210 | MSE: 0.066210 | RMSE: 0.257313 | MAE: 0.160638
============================================================
No improvement for 5 epochs

============================================================
Epoch 78/150
Learning Rate: 3.13e-05
============================================================

============================================================
Epoch 78 Summary:
  Train - Loss: 0.054831 | MSE: 0.054831 | RMSE: 0.234161 | MAE: 0.163808
  Val   - Loss: 0.066024 | MSE: 0.066024 | RMSE: 0.256952 | MAE: 0.161033
============================================================
No improvement for 6 epochs

============================================================
Epoch 79/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 79 Summary:
  Train - Loss: 0.054720 | MSE: 0.054720 | RMSE: 0.233923 | MAE: 0.163103
  Val   - Loss: 0.067033 | MSE: 0.067033 | RMSE: 0.258908 | MAE: 0.160962
============================================================
No improvement for 7 epochs

============================================================
Epoch 80/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 80 Summary:
  Train - Loss: 0.054390 | MSE: 0.054390 | RMSE: 0.233216 | MAE: 0.162872
  Val   - Loss: 0.067181 | MSE: 0.067181 | RMSE: 0.259193 | MAE: 0.160491
============================================================
No improvement for 8 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_80.pt

============================================================
Epoch 81/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 81 Summary:
  Train - Loss: 0.054507 | MSE: 0.054507 | RMSE: 0.233468 | MAE: 0.162961
  Val   - Loss: 0.066407 | MSE: 0.066407 | RMSE: 0.257696 | MAE: 0.161149
============================================================
No improvement for 9 epochs

============================================================
Epoch 82/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 82 Summary:
  Train - Loss: 0.054411 | MSE: 0.054411 | RMSE: 0.233261 | MAE: 0.162784
  Val   - Loss: 0.065094 | MSE: 0.065094 | RMSE: 0.255135 | MAE: 0.159796
============================================================

✓ New best model saved! Val Loss: 0.065094

============================================================
Epoch 83/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 83 Summary:
  Train - Loss: 0.054344 | MSE: 0.054344 | RMSE: 0.233119 | MAE: 0.162852
  Val   - Loss: 0.067124 | MSE: 0.067124 | RMSE: 0.259083 | MAE: 0.159823
============================================================
No improvement for 1 epochs

============================================================
Epoch 84/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 84 Summary:
  Train - Loss: 0.054300 | MSE: 0.054300 | RMSE: 0.233024 | MAE: 0.162581
  Val   - Loss: 0.065499 | MSE: 0.065499 | RMSE: 0.255928 | MAE: 0.160624
============================================================
No improvement for 2 epochs

============================================================
Epoch 85/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 85 Summary:
  Train - Loss: 0.054275 | MSE: 0.054275 | RMSE: 0.232971 | MAE: 0.162745
  Val   - Loss: 0.067012 | MSE: 0.067012 | RMSE: 0.258866 | MAE: 0.161049
============================================================
No improvement for 3 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_85.pt

============================================================
Epoch 86/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 86 Summary:
  Train - Loss: 0.054353 | MSE: 0.054353 | RMSE: 0.233138 | MAE: 0.162727
  Val   - Loss: 0.064963 | MSE: 0.064963 | RMSE: 0.254879 | MAE: 0.160202
============================================================

✓ New best model saved! Val Loss: 0.064963

============================================================
Epoch 87/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 87 Summary:
  Train - Loss: 0.054461 | MSE: 0.054461 | RMSE: 0.233370 | MAE: 0.162689
  Val   - Loss: 0.066643 | MSE: 0.066643 | RMSE: 0.258153 | MAE: 0.160243
============================================================
No improvement for 1 epochs

============================================================
Epoch 88/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 88 Summary:
  Train - Loss: 0.054063 | MSE: 0.054063 | RMSE: 0.232515 | MAE: 0.162547
  Val   - Loss: 0.066431 | MSE: 0.066431 | RMSE: 0.257742 | MAE: 0.160562
============================================================
No improvement for 2 epochs

============================================================
Epoch 89/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 89 Summary:
  Train - Loss: 0.054011 | MSE: 0.054011 | RMSE: 0.232402 | MAE: 0.162614
  Val   - Loss: 0.065317 | MSE: 0.065317 | RMSE: 0.255571 | MAE: 0.160634
============================================================
No improvement for 3 epochs

============================================================
Epoch 90/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 90 Summary:
  Train - Loss: 0.054024 | MSE: 0.054024 | RMSE: 0.232431 | MAE: 0.162391
  Val   - Loss: 0.065574 | MSE: 0.065574 | RMSE: 0.256074 | MAE: 0.162020
============================================================
No improvement for 4 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_90.pt

============================================================
Epoch 91/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 91 Summary:
  Train - Loss: 0.054231 | MSE: 0.054231 | RMSE: 0.232875 | MAE: 0.162648
  Val   - Loss: 0.066474 | MSE: 0.066474 | RMSE: 0.257826 | MAE: 0.161504
============================================================
No improvement for 5 epochs

============================================================
Epoch 92/150
Learning Rate: 1.56e-05
============================================================

============================================================
Epoch 92 Summary:
  Train - Loss: 0.054150 | MSE: 0.054150 | RMSE: 0.232702 | MAE: 0.162518
  Val   - Loss: 0.066480 | MSE: 0.066480 | RMSE: 0.257836 | MAE: 0.161284
============================================================
No improvement for 6 epochs

============================================================
Epoch 93/150
Learning Rate: 7.81e-06
============================================================

============================================================
Epoch 93 Summary:
  Train - Loss: 0.054072 | MSE: 0.054072 | RMSE: 0.232533 | MAE: 0.162388
  Val   - Loss: 0.066045 | MSE: 0.066045 | RMSE: 0.256993 | MAE: 0.160340
============================================================
No improvement for 7 epochs

============================================================
Epoch 94/150
Learning Rate: 7.81e-06
============================================================

============================================================
Epoch 94 Summary:
  Train - Loss: 0.053760 | MSE: 0.053760 | RMSE: 0.231861 | MAE: 0.162119
  Val   - Loss: 0.065839 | MSE: 0.065839 | RMSE: 0.256592 | MAE: 0.160826
============================================================
No improvement for 8 epochs

============================================================
Epoch 95/150
Learning Rate: 7.81e-06
============================================================

============================================================
Epoch 95 Summary:
  Train - Loss: 0.053550 | MSE: 0.053550 | RMSE: 0.231409 | MAE: 0.162003
  Val   - Loss: 0.065637 | MSE: 0.065637 | RMSE: 0.256197 | MAE: 0.161289
============================================================
No improvement for 9 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_95.pt

============================================================
Epoch 96/150
Learning Rate: 7.81e-06
============================================================

============================================================
Epoch 96 Summary:
  Train - Loss: 0.053839 | MSE: 0.053839 | RMSE: 0.232033 | MAE: 0.162245
  Val   - Loss: 0.066424 | MSE: 0.066424 | RMSE: 0.257729 | MAE: 0.160593
============================================================
No improvement for 10 epochs

============================================================
Epoch 97/150
Learning Rate: 7.81e-06
============================================================

============================================================
Epoch 97 Summary:
  Train - Loss: 0.053717 | MSE: 0.053717 | RMSE: 0.231768 | MAE: 0.162163
  Val   - Loss: 0.065411 | MSE: 0.065411 | RMSE: 0.255755 | MAE: 0.160111
============================================================
No improvement for 11 epochs

============================================================
Epoch 98/150
Learning Rate: 7.81e-06
============================================================

============================================================
Epoch 98 Summary:
  Train - Loss: 0.053898 | MSE: 0.053898 | RMSE: 0.232160 | MAE: 0.162269
  Val   - Loss: 0.065820 | MSE: 0.065820 | RMSE: 0.256555 | MAE: 0.159914
============================================================
No improvement for 12 epochs

============================================================
Epoch 99/150
Learning Rate: 3.91e-06
============================================================

============================================================
Epoch 99 Summary:
  Train - Loss: 0.053755 | MSE: 0.053755 | RMSE: 0.231851 | MAE: 0.161926
  Val   - Loss: 0.065982 | MSE: 0.065982 | RMSE: 0.256869 | MAE: 0.160093
============================================================
No improvement for 13 epochs

============================================================
Epoch 100/150
Learning Rate: 3.91e-06
============================================================

============================================================
Epoch 100 Summary:
  Train - Loss: 0.053939 | MSE: 0.053939 | RMSE: 0.232247 | MAE: 0.162028
  Val   - Loss: 0.066843 | MSE: 0.066843 | RMSE: 0.258540 | MAE: 0.160115
============================================================
No improvement for 14 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_epoch_100.pt

============================================================
Epoch 101/150
Learning Rate: 3.91e-06
============================================================

============================================================
Epoch 101 Summary:
  Train - Loss: 0.053712 | MSE: 0.053712 | RMSE: 0.231758 | MAE: 0.161872
  Val   - Loss: 0.065287 | MSE: 0.065287 | RMSE: 0.255514 | MAE: 0.160629
============================================================
No improvement for 15 epochs

Early stopping triggered after 15 epochs without improvement
Best validation loss: 0.064963

Final model saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/model_final.pt
Training history saved: src/trained_weights/UMambaMag_v2_STEAD_20251116_145324/training_history_20251116_145324.pt

============================================================
TRAINING COMPLETED
============================================================
Best validation loss: 0.064963
Best validation RMSE: 0.254879
Final train loss: 0.053712
Final val loss: 0.065287
Total Training Time: 45:46:21
============================================================
==================================================


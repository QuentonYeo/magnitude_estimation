2025-11-04 02:11:31,455 | seisbench | WARNING | Setting remote root to: https://seisbench.gfz.de/mirror/
Please note that this can affect your download speed.
2025-11-04 02:11:41,166 | seisbench | WARNING | Output component order not specified, defaulting to 'ZNE'.
2025-11-04 02:11:47,243 | seisbench | WARNING | Skipping preload, as cache is disabled.
2025-11-04 02:11:52,386 | seisbench | WARNING | Skipping preload, as cache is disabled.
/home/quenton.yeo/code/.venv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:60: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(

==================================================
LOADING DATA
==================================================
STEAD dataset loaded: 1265657 samples

Training umamba_mag_v2 on STEAD for 150 epochs...
Model moved to cuda:0
Training UMamba V2 Magnitude Estimator model (encoder-only with pooling)

============================================================
TRAINING UMAMBAMAG V2 (ENCODER-ONLY WITH POOLING)
============================================================
Model: UMambaMag_v2_STEAD
Dataset: STEAD
Batch size: 32
Learning rate: 0.001
Epochs: 150
Warmup epochs: 5
============================================================
Model is on device: cuda:0
Total parameters: 114,877
Trainable parameters: 114,877

Loading data...
Train batches: 33619
Dev batches: 1978

Saving models to: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152


============================================================
Epoch 1/150
Learning Rate: 1.00e-04
============================================================

============================================================
Epoch 1 Summary:
  Train - Loss: 0.272030 | MSE: 0.272030 | RMSE: 0.521565 | MAE: 0.358136
  Val   - Loss: 0.180795 | MSE: 0.180795 | RMSE: 0.425200 | MAE: 0.285201
============================================================

✓ New best model saved! Val Loss: 0.180795

============================================================
Epoch 2/150
Learning Rate: 2.80e-04
============================================================

============================================================
Epoch 2 Summary:
  Train - Loss: 0.193086 | MSE: 0.193086 | RMSE: 0.439415 | MAE: 0.303681
  Val   - Loss: 0.150982 | MSE: 0.150982 | RMSE: 0.388564 | MAE: 0.260537
============================================================

✓ New best model saved! Val Loss: 0.150982

============================================================
Epoch 3/150
Learning Rate: 4.60e-04
============================================================

============================================================
Epoch 3 Summary:
  Train - Loss: 0.161172 | MSE: 0.161172 | RMSE: 0.401463 | MAE: 0.276663
  Val   - Loss: 0.128711 | MSE: 0.128711 | RMSE: 0.358763 | MAE: 0.242141
============================================================

✓ New best model saved! Val Loss: 0.128711

============================================================
Epoch 4/150
Learning Rate: 6.40e-04
============================================================

============================================================
Epoch 4 Summary:
  Train - Loss: 0.142737 | MSE: 0.142737 | RMSE: 0.377806 | MAE: 0.260860
  Val   - Loss: 0.122700 | MSE: 0.122700 | RMSE: 0.350286 | MAE: 0.236976
============================================================

✓ New best model saved! Val Loss: 0.122700

============================================================
Epoch 5/150
Learning Rate: 8.20e-04
============================================================

============================================================
Epoch 5 Summary:
  Train - Loss: 0.132654 | MSE: 0.132654 | RMSE: 0.364217 | MAE: 0.251739
  Val   - Loss: 0.107743 | MSE: 0.107743 | RMSE: 0.328242 | MAE: 0.225178
============================================================

✓ New best model saved! Val Loss: 0.107743
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/model_epoch_5.pt

============================================================
Epoch 6/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 6 Summary:
  Train - Loss: 0.127144 | MSE: 0.127144 | RMSE: 0.356572 | MAE: 0.246606
  Val   - Loss: 0.113170 | MSE: 0.113170 | RMSE: 0.336408 | MAE: 0.225317
============================================================
No improvement for 1 epochs

============================================================
Epoch 7/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 7 Summary:
  Train - Loss: 0.120210 | MSE: 0.120210 | RMSE: 0.346713 | MAE: 0.239507
  Val   - Loss: 0.110045 | MSE: 0.110045 | RMSE: 0.331730 | MAE: 0.219871
============================================================
No improvement for 2 epochs

============================================================
Epoch 8/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 8 Summary:
  Train - Loss: 0.115166 | MSE: 0.115166 | RMSE: 0.339361 | MAE: 0.234479
  Val   - Loss: 0.100684 | MSE: 0.100684 | RMSE: 0.317307 | MAE: 0.208376
============================================================

✓ New best model saved! Val Loss: 0.100684

============================================================
Epoch 9/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 9 Summary:
  Train - Loss: 0.111797 | MSE: 0.111797 | RMSE: 0.334361 | MAE: 0.230773
  Val   - Loss: 0.098296 | MSE: 0.098296 | RMSE: 0.313522 | MAE: 0.207913
============================================================

✓ New best model saved! Val Loss: 0.098296

============================================================
Epoch 10/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 10 Summary:
  Train - Loss: 0.108849 | MSE: 0.108849 | RMSE: 0.329923 | MAE: 0.227645
  Val   - Loss: 0.093018 | MSE: 0.093018 | RMSE: 0.304988 | MAE: 0.198403
============================================================

✓ New best model saved! Val Loss: 0.093018
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/model_epoch_10.pt

============================================================
Epoch 11/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 11 Summary:
  Train - Loss: 0.106853 | MSE: 0.106853 | RMSE: 0.326884 | MAE: 0.225406
  Val   - Loss: 0.095716 | MSE: 0.095716 | RMSE: 0.309379 | MAE: 0.211916
============================================================
No improvement for 1 epochs

============================================================
Epoch 12/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 12 Summary:
  Train - Loss: 0.104789 | MSE: 0.104789 | RMSE: 0.323711 | MAE: 0.223272
  Val   - Loss: 0.094029 | MSE: 0.094029 | RMSE: 0.306642 | MAE: 0.202591
============================================================
No improvement for 2 epochs

============================================================
Epoch 13/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 13 Summary:
  Train - Loss: 0.103732 | MSE: 0.103732 | RMSE: 0.322075 | MAE: 0.222015
  Val   - Loss: 0.091152 | MSE: 0.091152 | RMSE: 0.301914 | MAE: 0.194527
============================================================

✓ New best model saved! Val Loss: 0.091152

============================================================
Epoch 14/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 14 Summary:
  Train - Loss: 0.102395 | MSE: 0.102395 | RMSE: 0.319992 | MAE: 0.220474
  Val   - Loss: 0.086386 | MSE: 0.086386 | RMSE: 0.293914 | MAE: 0.190430
============================================================

✓ New best model saved! Val Loss: 0.086386

============================================================
Epoch 15/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 15 Summary:
  Train - Loss: 0.101669 | MSE: 0.101669 | RMSE: 0.318855 | MAE: 0.219351
  Val   - Loss: 0.089214 | MSE: 0.089214 | RMSE: 0.298687 | MAE: 0.193329
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/model_epoch_15.pt

============================================================
Epoch 16/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 16 Summary:
  Train - Loss: 0.100301 | MSE: 0.100301 | RMSE: 0.316704 | MAE: 0.218191
  Val   - Loss: 0.090108 | MSE: 0.090108 | RMSE: 0.300181 | MAE: 0.204891
============================================================
No improvement for 2 epochs

============================================================
Epoch 17/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 17 Summary:
  Train - Loss: 0.099564 | MSE: 0.099564 | RMSE: 0.315538 | MAE: 0.217249
  Val   - Loss: 0.091207 | MSE: 0.091207 | RMSE: 0.302004 | MAE: 0.196631
============================================================
No improvement for 3 epochs

============================================================
Epoch 18/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 18 Summary:
  Train - Loss: 0.098879 | MSE: 0.098879 | RMSE: 0.314450 | MAE: 0.216215
  Val   - Loss: 0.086421 | MSE: 0.086421 | RMSE: 0.293975 | MAE: 0.193063
============================================================
No improvement for 4 epochs

============================================================
Epoch 19/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 19 Summary:
  Train - Loss: 0.098108 | MSE: 0.098108 | RMSE: 0.313221 | MAE: 0.215621
  Val   - Loss: 0.085332 | MSE: 0.085332 | RMSE: 0.292117 | MAE: 0.189287
============================================================

✓ New best model saved! Val Loss: 0.085332

============================================================
Epoch 20/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 20 Summary:
  Train - Loss: 0.097477 | MSE: 0.097477 | RMSE: 0.312213 | MAE: 0.214988
  Val   - Loss: 0.085224 | MSE: 0.085224 | RMSE: 0.291932 | MAE: 0.192085
============================================================

✓ New best model saved! Val Loss: 0.085224
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/model_epoch_20.pt

============================================================
Epoch 21/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 21 Summary:
  Train - Loss: 0.096719 | MSE: 0.096719 | RMSE: 0.310997 | MAE: 0.214330
  Val   - Loss: 0.087273 | MSE: 0.087273 | RMSE: 0.295421 | MAE: 0.192467
============================================================
No improvement for 1 epochs

============================================================
Epoch 22/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 22 Summary:
  Train - Loss: 0.095989 | MSE: 0.095989 | RMSE: 0.309821 | MAE: 0.213614
  Val   - Loss: 0.084406 | MSE: 0.084406 | RMSE: 0.290527 | MAE: 0.196594
============================================================

✓ New best model saved! Val Loss: 0.084406

============================================================
Epoch 23/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 23 Summary:
  Train - Loss: 0.096351 | MSE: 0.096351 | RMSE: 0.310404 | MAE: 0.213755
  Val   - Loss: 0.089718 | MSE: 0.089718 | RMSE: 0.299530 | MAE: 0.192229
============================================================
No improvement for 1 epochs

============================================================
Epoch 24/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 24 Summary:
  Train - Loss: 0.095430 | MSE: 0.095430 | RMSE: 0.308918 | MAE: 0.212977
  Val   - Loss: 0.081293 | MSE: 0.081293 | RMSE: 0.285120 | MAE: 0.184633
============================================================

✓ New best model saved! Val Loss: 0.081293

============================================================
Epoch 25/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 25 Summary:
  Train - Loss: 0.094736 | MSE: 0.094736 | RMSE: 0.307792 | MAE: 0.212047
  Val   - Loss: 0.081722 | MSE: 0.081722 | RMSE: 0.285870 | MAE: 0.185115
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/model_epoch_25.pt

============================================================
Epoch 26/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 26 Summary:
  Train - Loss: 0.094209 | MSE: 0.094209 | RMSE: 0.306935 | MAE: 0.211523
  Val   - Loss: 0.084216 | MSE: 0.084216 | RMSE: 0.290200 | MAE: 0.185189
============================================================
No improvement for 2 epochs

============================================================
Epoch 27/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 27 Summary:
  Train - Loss: 0.094044 | MSE: 0.094044 | RMSE: 0.306666 | MAE: 0.211096
  Val   - Loss: 0.083297 | MSE: 0.083297 | RMSE: 0.288612 | MAE: 0.186724
============================================================
No improvement for 3 epochs

============================================================
Epoch 28/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 28 Summary:
  Train - Loss: 0.093742 | MSE: 0.093742 | RMSE: 0.306174 | MAE: 0.210738
  Val   - Loss: 0.082926 | MSE: 0.082926 | RMSE: 0.287968 | MAE: 0.188157
============================================================
No improvement for 4 epochs

============================================================
Epoch 29/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 29 Summary:
  Train - Loss: 0.093044 | MSE: 0.093044 | RMSE: 0.305031 | MAE: 0.210088
  Val   - Loss: 0.081813 | MSE: 0.081813 | RMSE: 0.286030 | MAE: 0.189028
============================================================
No improvement for 5 epochs

============================================================
Epoch 30/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 30 Summary:
  Train - Loss: 0.093121 | MSE: 0.093121 | RMSE: 0.305157 | MAE: 0.210055
  Val   - Loss: 0.080505 | MSE: 0.080505 | RMSE: 0.283735 | MAE: 0.190649
============================================================

✓ New best model saved! Val Loss: 0.080505
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/model_epoch_30.pt

============================================================
Epoch 31/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 31 Summary:
  Train - Loss: 0.092130 | MSE: 0.092130 | RMSE: 0.303530 | MAE: 0.209307
  Val   - Loss: 0.079468 | MSE: 0.079468 | RMSE: 0.281900 | MAE: 0.184823
============================================================

✓ New best model saved! Val Loss: 0.079468

============================================================
Epoch 32/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 32 Summary:
  Train - Loss: 0.092592 | MSE: 0.092592 | RMSE: 0.304289 | MAE: 0.209408
  Val   - Loss: 0.081767 | MSE: 0.081767 | RMSE: 0.285949 | MAE: 0.184539
============================================================
No improvement for 1 epochs

============================================================
Epoch 33/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 33 Summary:
  Train - Loss: 0.092075 | MSE: 0.092075 | RMSE: 0.303439 | MAE: 0.208683
  Val   - Loss: 0.080258 | MSE: 0.080258 | RMSE: 0.283299 | MAE: 0.181617
============================================================
No improvement for 2 epochs

============================================================
Epoch 34/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 34 Summary:
  Train - Loss: 0.091924 | MSE: 0.091924 | RMSE: 0.303189 | MAE: 0.208734
  Val   - Loss: 0.081323 | MSE: 0.081323 | RMSE: 0.285172 | MAE: 0.189822
============================================================
No improvement for 3 epochs

============================================================
Epoch 35/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 35 Summary:
  Train - Loss: 0.091089 | MSE: 0.091089 | RMSE: 0.301809 | MAE: 0.207908
  Val   - Loss: 0.080689 | MSE: 0.080689 | RMSE: 0.284057 | MAE: 0.181970
============================================================
No improvement for 4 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/model_epoch_35.pt

============================================================
Epoch 36/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 36 Summary:
  Train - Loss: 0.090964 | MSE: 0.090964 | RMSE: 0.301602 | MAE: 0.207833
  Val   - Loss: 0.082809 | MSE: 0.082809 | RMSE: 0.287766 | MAE: 0.185369
============================================================
No improvement for 5 epochs

============================================================
Epoch 37/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 37 Summary:
  Train - Loss: 0.090720 | MSE: 0.090720 | RMSE: 0.301197 | MAE: 0.207431
  Val   - Loss: 0.080486 | MSE: 0.080486 | RMSE: 0.283701 | MAE: 0.189208
============================================================
No improvement for 6 epochs

============================================================
Epoch 38/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 38 Summary:
  Train - Loss: 0.084430 | MSE: 0.084430 | RMSE: 0.290568 | MAE: 0.199662
  Val   - Loss: 0.073763 | MSE: 0.073763 | RMSE: 0.271594 | MAE: 0.175551
============================================================

✓ New best model saved! Val Loss: 0.073763

============================================================
Epoch 39/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 39 Summary:
  Train - Loss: 0.090017 | MSE: 0.090017 | RMSE: 0.300029 | MAE: 0.206537
  Val   - Loss: 0.078159 | MSE: 0.078159 | RMSE: 0.279569 | MAE: 0.181071
============================================================
No improvement for 1 epochs

============================================================
Epoch 40/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 40 Summary:
  Train - Loss: 0.090320 | MSE: 0.090320 | RMSE: 0.300534 | MAE: 0.206848
  Val   - Loss: 0.080447 | MSE: 0.080447 | RMSE: 0.283632 | MAE: 0.186689
============================================================
No improvement for 2 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/model_epoch_40.pt

============================================================
Epoch 41/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 41 Summary:
  Train - Loss: 0.089999 | MSE: 0.089999 | RMSE: 0.299999 | MAE: 0.206417
  Val   - Loss: 0.080850 | MSE: 0.080850 | RMSE: 0.284342 | MAE: 0.183285
============================================================
No improvement for 3 epochs

============================================================
Epoch 42/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 42 Summary:
  Train - Loss: 0.089364 | MSE: 0.089364 | RMSE: 0.298938 | MAE: 0.206336
  Val   - Loss: 0.079839 | MSE: 0.079839 | RMSE: 0.282558 | MAE: 0.181844
============================================================
No improvement for 4 epochs

============================================================
Epoch 43/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 43 Summary:
  Train - Loss: 0.089756 | MSE: 0.089756 | RMSE: 0.299594 | MAE: 0.206093
  Val   - Loss: 0.078978 | MSE: 0.078978 | RMSE: 0.281030 | MAE: 0.184521
============================================================
No improvement for 5 epochs

============================================================
Epoch 44/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 44 Summary:
  Train - Loss: 0.089462 | MSE: 0.089462 | RMSE: 0.299102 | MAE: 0.205967
  Val   - Loss: 0.078265 | MSE: 0.078265 | RMSE: 0.279759 | MAE: 0.180708
============================================================
No improvement for 6 epochs

============================================================
Epoch 45/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 45 Summary:
  Train - Loss: 0.083568 | MSE: 0.083568 | RMSE: 0.289082 | MAE: 0.198489
  Val   - Loss: 0.074968 | MSE: 0.074968 | RMSE: 0.273803 | MAE: 0.180262
============================================================
No improvement for 7 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/model_epoch_45.pt

============================================================
Epoch 46/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 46 Summary:
  Train - Loss: 0.089048 | MSE: 0.089048 | RMSE: 0.298410 | MAE: 0.205196
  Val   - Loss: 0.080101 | MSE: 0.080101 | RMSE: 0.283021 | MAE: 0.183369
============================================================
No improvement for 8 epochs

============================================================
Epoch 47/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 47 Summary:
  Train - Loss: 0.088720 | MSE: 0.088720 | RMSE: 0.297859 | MAE: 0.205137
  Val   - Loss: 0.079550 | MSE: 0.079550 | RMSE: 0.282046 | MAE: 0.184328
============================================================
No improvement for 9 epochs

============================================================
Epoch 48/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 48 Summary:
  Train - Loss: 0.088770 | MSE: 0.088770 | RMSE: 0.297943 | MAE: 0.205126
  Val   - Loss: 0.079968 | MSE: 0.079968 | RMSE: 0.282786 | MAE: 0.187959
============================================================
No improvement for 10 epochs

============================================================
Epoch 49/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 49 Summary:
  Train - Loss: 0.088468 | MSE: 0.088468 | RMSE: 0.297435 | MAE: 0.204835
  Val   - Loss: 0.081340 | MSE: 0.081340 | RMSE: 0.285201 | MAE: 0.198419
============================================================
No improvement for 11 epochs

============================================================
Epoch 50/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 50 Summary:
  Train - Loss: 0.088941 | MSE: 0.088941 | RMSE: 0.298229 | MAE: 0.205058
  Val   - Loss: 0.078064 | MSE: 0.078064 | RMSE: 0.279399 | MAE: 0.179163
============================================================
No improvement for 12 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/model_epoch_50.pt

============================================================
Epoch 51/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 51 Summary:
  Train - Loss: 0.082817 | MSE: 0.082817 | RMSE: 0.287779 | MAE: 0.197506
  Val   - Loss: 0.075699 | MSE: 0.075699 | RMSE: 0.275135 | MAE: 0.184350
============================================================
No improvement for 13 epochs

============================================================
Epoch 52/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 52 Summary:
  Train - Loss: 0.087775 | MSE: 0.087775 | RMSE: 0.296268 | MAE: 0.203947
  Val   - Loss: 0.079548 | MSE: 0.079548 | RMSE: 0.282042 | MAE: 0.182394
============================================================
No improvement for 14 epochs

============================================================
Epoch 53/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 53 Summary:
  Train - Loss: 0.088307 | MSE: 0.088307 | RMSE: 0.297165 | MAE: 0.204217
  Val   - Loss: 0.079424 | MSE: 0.079424 | RMSE: 0.281823 | MAE: 0.183189
============================================================
No improvement for 15 epochs

Early stopping triggered after 15 epochs without improvement
Best validation loss: 0.073763

Final model saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/model_final.pt
Training history saved: src/trained_weights/UMambaMag_v2_STEAD_20251104_021152/training_history_20251104_021152.pt

============================================================
TRAINING COMPLETED
============================================================
Best validation loss: 0.073763
Best validation RMSE: 0.271594
Final train loss: 0.088307
Final val loss: 0.079424
Total Training Time: 08:40:16
============================================================
==================================================


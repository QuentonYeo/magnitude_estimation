2025-11-09 13:54:43,639 | seisbench | WARNING | Setting remote root to: https://seisbench.gfz.de/mirror/
Please note that this can affect your download speed.
2025-11-09 13:54:56,687 | seisbench | WARNING | Output component order not specified, defaulting to 'ZNE'.
2025-11-09 13:55:03,768 | seisbench | WARNING | Skipping preload, as cache is disabled.
2025-11-09 13:55:11,076 | seisbench | WARNING | Skipping preload, as cache is disabled.
/home/quenton.yeo/code/.venv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:60: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(

==================================================
LOADING DATA
==================================================
STEAD dataset loaded: 1265657 samples

Training umamba_mag_v2 on STEAD for 150 epochs...
Model moved to cuda:1
Training UMamba V2 Magnitude Estimator model (encoder-only with pooling)

============================================================
TRAINING UMAMBAMAG V2 (ENCODER-ONLY WITH POOLING)
============================================================
Model: UMambaMag_v2_STEAD
Dataset: STEAD
Batch size: 32
Learning rate: 0.001
Epochs: 150
Warmup epochs: 5
============================================================
Model is on device: cuda:1
Total parameters: 191,313
Trainable parameters: 191,313

Loading data...
Train batches: 33619
Dev batches: 1978

Saving models to: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511


============================================================
Epoch 1/150
Learning Rate: 1.00e-04
============================================================

============================================================
Epoch 1 Summary:
  Train - Loss: 0.287601 | MSE: 0.287601 | RMSE: 0.536284 | MAE: 0.369354
  Val   - Loss: 0.178892 | MSE: 0.178892 | RMSE: 0.422956 | MAE: 0.290868
============================================================

✓ New best model saved! Val Loss: 0.178892

============================================================
Epoch 2/150
Learning Rate: 2.80e-04
============================================================

============================================================
Epoch 2 Summary:
  Train - Loss: 0.189314 | MSE: 0.189314 | RMSE: 0.435102 | MAE: 0.300285
  Val   - Loss: 0.161673 | MSE: 0.161673 | RMSE: 0.402086 | MAE: 0.268847
============================================================

✓ New best model saved! Val Loss: 0.161673

============================================================
Epoch 3/150
Learning Rate: 4.60e-04
============================================================

============================================================
Epoch 3 Summary:
  Train - Loss: 0.159201 | MSE: 0.159201 | RMSE: 0.399000 | MAE: 0.274788
  Val   - Loss: 0.140058 | MSE: 0.140058 | RMSE: 0.374244 | MAE: 0.251038
============================================================

✓ New best model saved! Val Loss: 0.140058

============================================================
Epoch 4/150
Learning Rate: 6.40e-04
============================================================

============================================================
Epoch 4 Summary:
  Train - Loss: 0.143341 | MSE: 0.143341 | RMSE: 0.378604 | MAE: 0.261254
  Val   - Loss: 0.123763 | MSE: 0.123763 | RMSE: 0.351799 | MAE: 0.236724
============================================================

✓ New best model saved! Val Loss: 0.123763

============================================================
Epoch 5/150
Learning Rate: 8.20e-04
============================================================

============================================================
Epoch 5 Summary:
  Train - Loss: 0.134255 | MSE: 0.134255 | RMSE: 0.366409 | MAE: 0.253527
  Val   - Loss: 0.108538 | MSE: 0.108538 | RMSE: 0.329451 | MAE: 0.222698
============================================================

✓ New best model saved! Val Loss: 0.108538
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_5.pt

============================================================
Epoch 6/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 6 Summary:
  Train - Loss: 0.129150 | MSE: 0.129150 | RMSE: 0.359375 | MAE: 0.248581
  Val   - Loss: 0.110034 | MSE: 0.110034 | RMSE: 0.331714 | MAE: 0.218123
============================================================
No improvement for 1 epochs

============================================================
Epoch 7/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 7 Summary:
  Train - Loss: 0.121762 | MSE: 0.121762 | RMSE: 0.348944 | MAE: 0.241852
  Val   - Loss: 0.108060 | MSE: 0.108060 | RMSE: 0.328725 | MAE: 0.214697
============================================================

✓ New best model saved! Val Loss: 0.108060

============================================================
Epoch 8/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 8 Summary:
  Train - Loss: 0.116862 | MSE: 0.116862 | RMSE: 0.341851 | MAE: 0.236308
  Val   - Loss: 0.097974 | MSE: 0.097974 | RMSE: 0.313009 | MAE: 0.208340
============================================================

✓ New best model saved! Val Loss: 0.097974

============================================================
Epoch 9/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 9 Summary:
  Train - Loss: 0.112885 | MSE: 0.112885 | RMSE: 0.335984 | MAE: 0.232531
  Val   - Loss: 0.101939 | MSE: 0.101939 | RMSE: 0.319279 | MAE: 0.207539
============================================================
No improvement for 1 epochs

============================================================
Epoch 10/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 10 Summary:
  Train - Loss: 0.110261 | MSE: 0.110261 | RMSE: 0.332056 | MAE: 0.229690
  Val   - Loss: 0.100130 | MSE: 0.100130 | RMSE: 0.316433 | MAE: 0.212445
============================================================
No improvement for 2 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_10.pt

============================================================
Epoch 11/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 11 Summary:
  Train - Loss: 0.108356 | MSE: 0.108356 | RMSE: 0.329174 | MAE: 0.227333
  Val   - Loss: 0.095417 | MSE: 0.095417 | RMSE: 0.308897 | MAE: 0.204665
============================================================

✓ New best model saved! Val Loss: 0.095417

============================================================
Epoch 12/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 12 Summary:
  Train - Loss: 0.105803 | MSE: 0.105803 | RMSE: 0.325273 | MAE: 0.224922
  Val   - Loss: 0.090856 | MSE: 0.090856 | RMSE: 0.301423 | MAE: 0.199643
============================================================

✓ New best model saved! Val Loss: 0.090856

============================================================
Epoch 13/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 13 Summary:
  Train - Loss: 0.104544 | MSE: 0.104544 | RMSE: 0.323333 | MAE: 0.223102
  Val   - Loss: 0.093864 | MSE: 0.093864 | RMSE: 0.306372 | MAE: 0.202649
============================================================
No improvement for 1 epochs

============================================================
Epoch 14/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 14 Summary:
  Train - Loss: 0.102531 | MSE: 0.102531 | RMSE: 0.320204 | MAE: 0.221260
  Val   - Loss: 0.092484 | MSE: 0.092484 | RMSE: 0.304111 | MAE: 0.198231
============================================================
No improvement for 2 epochs

============================================================
Epoch 15/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 15 Summary:
  Train - Loss: 0.101500 | MSE: 0.101500 | RMSE: 0.318591 | MAE: 0.219759
  Val   - Loss: 0.088407 | MSE: 0.088407 | RMSE: 0.297334 | MAE: 0.196960
============================================================

✓ New best model saved! Val Loss: 0.088407
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_15.pt

============================================================
Epoch 16/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 16 Summary:
  Train - Loss: 0.099899 | MSE: 0.099899 | RMSE: 0.316068 | MAE: 0.218746
  Val   - Loss: 0.087429 | MSE: 0.087429 | RMSE: 0.295685 | MAE: 0.197886
============================================================

✓ New best model saved! Val Loss: 0.087429

============================================================
Epoch 17/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 17 Summary:
  Train - Loss: 0.099421 | MSE: 0.099421 | RMSE: 0.315311 | MAE: 0.217751
  Val   - Loss: 0.088366 | MSE: 0.088366 | RMSE: 0.297264 | MAE: 0.197653
============================================================
No improvement for 1 epochs

============================================================
Epoch 18/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 18 Summary:
  Train - Loss: 0.098565 | MSE: 0.098565 | RMSE: 0.313950 | MAE: 0.216537
  Val   - Loss: 0.087373 | MSE: 0.087373 | RMSE: 0.295589 | MAE: 0.197307
============================================================

✓ New best model saved! Val Loss: 0.087373

============================================================
Epoch 19/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 19 Summary:
  Train - Loss: 0.097692 | MSE: 0.097692 | RMSE: 0.312556 | MAE: 0.215591
  Val   - Loss: 0.088539 | MSE: 0.088539 | RMSE: 0.297555 | MAE: 0.193321
============================================================
No improvement for 1 epochs

============================================================
Epoch 20/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 20 Summary:
  Train - Loss: 0.097097 | MSE: 0.097097 | RMSE: 0.311603 | MAE: 0.214890
  Val   - Loss: 0.083953 | MSE: 0.083953 | RMSE: 0.289746 | MAE: 0.189940
============================================================

✓ New best model saved! Val Loss: 0.083953
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_20.pt

============================================================
Epoch 21/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 21 Summary:
  Train - Loss: 0.096164 | MSE: 0.096164 | RMSE: 0.310103 | MAE: 0.214003
  Val   - Loss: 0.085954 | MSE: 0.085954 | RMSE: 0.293180 | MAE: 0.194328
============================================================
No improvement for 1 epochs

============================================================
Epoch 22/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 22 Summary:
  Train - Loss: 0.095275 | MSE: 0.095275 | RMSE: 0.308667 | MAE: 0.213088
  Val   - Loss: 0.088546 | MSE: 0.088546 | RMSE: 0.297567 | MAE: 0.195751
============================================================
No improvement for 2 epochs

============================================================
Epoch 23/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 23 Summary:
  Train - Loss: 0.094751 | MSE: 0.094751 | RMSE: 0.307816 | MAE: 0.212657
  Val   - Loss: 0.085113 | MSE: 0.085113 | RMSE: 0.291742 | MAE: 0.191035
============================================================
No improvement for 3 epochs

============================================================
Epoch 24/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 24 Summary:
  Train - Loss: 0.094274 | MSE: 0.094274 | RMSE: 0.307040 | MAE: 0.212208
  Val   - Loss: 0.084744 | MSE: 0.084744 | RMSE: 0.291108 | MAE: 0.197419
============================================================
No improvement for 4 epochs

============================================================
Epoch 25/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 25 Summary:
  Train - Loss: 0.093764 | MSE: 0.093764 | RMSE: 0.306209 | MAE: 0.211240
  Val   - Loss: 0.082395 | MSE: 0.082395 | RMSE: 0.287046 | MAE: 0.189713
============================================================

✓ New best model saved! Val Loss: 0.082395
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_25.pt

============================================================
Epoch 26/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 26 Summary:
  Train - Loss: 0.093331 | MSE: 0.093331 | RMSE: 0.305501 | MAE: 0.210847
  Val   - Loss: 0.081213 | MSE: 0.081213 | RMSE: 0.284979 | MAE: 0.191099
============================================================

✓ New best model saved! Val Loss: 0.081213

============================================================
Epoch 27/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 27 Summary:
  Train - Loss: 0.092935 | MSE: 0.092935 | RMSE: 0.304852 | MAE: 0.210158
  Val   - Loss: 0.081959 | MSE: 0.081959 | RMSE: 0.286284 | MAE: 0.182590
============================================================
No improvement for 1 epochs

============================================================
Epoch 28/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 28 Summary:
  Train - Loss: 0.092030 | MSE: 0.092030 | RMSE: 0.303364 | MAE: 0.209484
  Val   - Loss: 0.085841 | MSE: 0.085841 | RMSE: 0.292986 | MAE: 0.191049
============================================================
No improvement for 2 epochs

============================================================
Epoch 29/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 29 Summary:
  Train - Loss: 0.091801 | MSE: 0.091801 | RMSE: 0.302987 | MAE: 0.209006
  Val   - Loss: 0.081596 | MSE: 0.081596 | RMSE: 0.285650 | MAE: 0.193151
============================================================
No improvement for 3 epochs

============================================================
Epoch 30/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 30 Summary:
  Train - Loss: 0.091484 | MSE: 0.091484 | RMSE: 0.302463 | MAE: 0.208489
  Val   - Loss: 0.085262 | MSE: 0.085262 | RMSE: 0.291996 | MAE: 0.187027
============================================================
No improvement for 4 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_30.pt

============================================================
Epoch 31/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 31 Summary:
  Train - Loss: 0.091131 | MSE: 0.091131 | RMSE: 0.301880 | MAE: 0.208240
  Val   - Loss: 0.078097 | MSE: 0.078097 | RMSE: 0.279459 | MAE: 0.180370
============================================================

✓ New best model saved! Val Loss: 0.078097

============================================================
Epoch 32/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 32 Summary:
  Train - Loss: 0.090570 | MSE: 0.090570 | RMSE: 0.300948 | MAE: 0.207582
  Val   - Loss: 0.078092 | MSE: 0.078092 | RMSE: 0.279449 | MAE: 0.182356
============================================================

✓ New best model saved! Val Loss: 0.078092

============================================================
Epoch 33/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 33 Summary:
  Train - Loss: 0.090591 | MSE: 0.090591 | RMSE: 0.300984 | MAE: 0.207569
  Val   - Loss: 0.079667 | MSE: 0.079667 | RMSE: 0.282253 | MAE: 0.187641
============================================================
No improvement for 1 epochs

============================================================
Epoch 34/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 34 Summary:
  Train - Loss: 0.089771 | MSE: 0.089771 | RMSE: 0.299618 | MAE: 0.206853
  Val   - Loss: 0.080135 | MSE: 0.080135 | RMSE: 0.283082 | MAE: 0.181530
============================================================
No improvement for 2 epochs

============================================================
Epoch 35/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 35 Summary:
  Train - Loss: 0.089788 | MSE: 0.089788 | RMSE: 0.299647 | MAE: 0.206359
  Val   - Loss: 0.077636 | MSE: 0.077636 | RMSE: 0.278633 | MAE: 0.191273
============================================================

✓ New best model saved! Val Loss: 0.077636
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_35.pt

============================================================
Epoch 36/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 36 Summary:
  Train - Loss: 0.089356 | MSE: 0.089356 | RMSE: 0.298926 | MAE: 0.206045
  Val   - Loss: 0.078912 | MSE: 0.078912 | RMSE: 0.280913 | MAE: 0.183060
============================================================
No improvement for 1 epochs

============================================================
Epoch 37/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 37 Summary:
  Train - Loss: 0.088855 | MSE: 0.088855 | RMSE: 0.298085 | MAE: 0.205718
  Val   - Loss: 0.080628 | MSE: 0.080628 | RMSE: 0.283951 | MAE: 0.188682
============================================================
No improvement for 2 epochs

============================================================
Epoch 38/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 38 Summary:
  Train - Loss: 0.088848 | MSE: 0.088848 | RMSE: 0.298074 | MAE: 0.205545
  Val   - Loss: 0.078269 | MSE: 0.078269 | RMSE: 0.279766 | MAE: 0.182267
============================================================
No improvement for 3 epochs

============================================================
Epoch 39/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 39 Summary:
  Train - Loss: 0.088518 | MSE: 0.088518 | RMSE: 0.297519 | MAE: 0.205113
  Val   - Loss: 0.078644 | MSE: 0.078644 | RMSE: 0.280436 | MAE: 0.186333
============================================================
No improvement for 4 epochs

============================================================
Epoch 40/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 40 Summary:
  Train - Loss: 0.088115 | MSE: 0.088115 | RMSE: 0.296841 | MAE: 0.204724
  Val   - Loss: 0.079406 | MSE: 0.079406 | RMSE: 0.281791 | MAE: 0.188180
============================================================
No improvement for 5 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_40.pt

============================================================
Epoch 41/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 41 Summary:
  Train - Loss: 0.087671 | MSE: 0.087671 | RMSE: 0.296094 | MAE: 0.204454
  Val   - Loss: 0.079089 | MSE: 0.079089 | RMSE: 0.281228 | MAE: 0.184230
============================================================
No improvement for 6 epochs

============================================================
Epoch 42/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 42 Summary:
  Train - Loss: 0.081563 | MSE: 0.081563 | RMSE: 0.285592 | MAE: 0.196596
  Val   - Loss: 0.072737 | MSE: 0.072737 | RMSE: 0.269698 | MAE: 0.172785
============================================================

✓ New best model saved! Val Loss: 0.072737

============================================================
Epoch 43/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 43 Summary:
  Train - Loss: 0.087018 | MSE: 0.087018 | RMSE: 0.294988 | MAE: 0.203734
  Val   - Loss: 0.076789 | MSE: 0.076789 | RMSE: 0.277108 | MAE: 0.184109
============================================================
No improvement for 1 epochs

============================================================
Epoch 44/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 44 Summary:
  Train - Loss: 0.087328 | MSE: 0.087328 | RMSE: 0.295512 | MAE: 0.203965
  Val   - Loss: 0.083723 | MSE: 0.083723 | RMSE: 0.289349 | MAE: 0.195744
============================================================
No improvement for 2 epochs

============================================================
Epoch 45/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 45 Summary:
  Train - Loss: 0.087263 | MSE: 0.087263 | RMSE: 0.295404 | MAE: 0.203662
  Val   - Loss: 0.079936 | MSE: 0.079936 | RMSE: 0.282729 | MAE: 0.181706
============================================================
No improvement for 3 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_45.pt

============================================================
Epoch 46/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 46 Summary:
  Train - Loss: 0.087018 | MSE: 0.087018 | RMSE: 0.294989 | MAE: 0.203340
  Val   - Loss: 0.075979 | MSE: 0.075979 | RMSE: 0.275643 | MAE: 0.184601
============================================================
No improvement for 4 epochs

============================================================
Epoch 47/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 47 Summary:
  Train - Loss: 0.086901 | MSE: 0.086901 | RMSE: 0.294790 | MAE: 0.203265
  Val   - Loss: 0.080085 | MSE: 0.080085 | RMSE: 0.282993 | MAE: 0.183415
============================================================
No improvement for 5 epochs

============================================================
Epoch 48/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 48 Summary:
  Train - Loss: 0.086596 | MSE: 0.086596 | RMSE: 0.294271 | MAE: 0.203070
  Val   - Loss: 0.078000 | MSE: 0.078000 | RMSE: 0.279285 | MAE: 0.180708
============================================================
No improvement for 6 epochs

============================================================
Epoch 49/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 49 Summary:
  Train - Loss: 0.079935 | MSE: 0.079935 | RMSE: 0.282729 | MAE: 0.194839
  Val   - Loss: 0.070282 | MSE: 0.070282 | RMSE: 0.265108 | MAE: 0.170681
============================================================

✓ New best model saved! Val Loss: 0.070282

============================================================
Epoch 50/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 50 Summary:
  Train - Loss: 0.085633 | MSE: 0.085633 | RMSE: 0.292630 | MAE: 0.201959
  Val   - Loss: 0.078450 | MSE: 0.078450 | RMSE: 0.280089 | MAE: 0.184945
============================================================
No improvement for 1 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_50.pt

============================================================
Epoch 51/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 51 Summary:
  Train - Loss: 0.086337 | MSE: 0.086337 | RMSE: 0.293831 | MAE: 0.202526
  Val   - Loss: 0.076349 | MSE: 0.076349 | RMSE: 0.276313 | MAE: 0.181208
============================================================
No improvement for 2 epochs

============================================================
Epoch 52/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 52 Summary:
  Train - Loss: 0.085309 | MSE: 0.085309 | RMSE: 0.292077 | MAE: 0.201791
  Val   - Loss: 0.075885 | MSE: 0.075885 | RMSE: 0.275472 | MAE: 0.176751
============================================================
No improvement for 3 epochs

============================================================
Epoch 53/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 53 Summary:
  Train - Loss: 0.085682 | MSE: 0.085682 | RMSE: 0.292714 | MAE: 0.201926
  Val   - Loss: 0.074248 | MSE: 0.074248 | RMSE: 0.272484 | MAE: 0.175739
============================================================
No improvement for 4 epochs

============================================================
Epoch 54/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 54 Summary:
  Train - Loss: 0.085509 | MSE: 0.085509 | RMSE: 0.292419 | MAE: 0.201693
  Val   - Loss: 0.075284 | MSE: 0.075284 | RMSE: 0.274380 | MAE: 0.175219
============================================================
No improvement for 5 epochs

============================================================
Epoch 55/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 55 Summary:
  Train - Loss: 0.085208 | MSE: 0.085208 | RMSE: 0.291904 | MAE: 0.201532
  Val   - Loss: 0.074837 | MSE: 0.074837 | RMSE: 0.273563 | MAE: 0.177879
============================================================
No improvement for 6 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_55.pt

============================================================
Epoch 56/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 56 Summary:
  Train - Loss: 0.079124 | MSE: 0.079124 | RMSE: 0.281290 | MAE: 0.193560
  Val   - Loss: 0.069267 | MSE: 0.069267 | RMSE: 0.263186 | MAE: 0.170070
============================================================

✓ New best model saved! Val Loss: 0.069267

============================================================
Epoch 57/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 57 Summary:
  Train - Loss: 0.084624 | MSE: 0.084624 | RMSE: 0.290902 | MAE: 0.200717
  Val   - Loss: 0.073188 | MSE: 0.073188 | RMSE: 0.270534 | MAE: 0.174827
============================================================
No improvement for 1 epochs

============================================================
Epoch 58/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 58 Summary:
  Train - Loss: 0.085001 | MSE: 0.085001 | RMSE: 0.291549 | MAE: 0.201035
  Val   - Loss: 0.078447 | MSE: 0.078447 | RMSE: 0.280083 | MAE: 0.187953
============================================================
No improvement for 2 epochs

============================================================
Epoch 59/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 59 Summary:
  Train - Loss: 0.084453 | MSE: 0.084453 | RMSE: 0.290608 | MAE: 0.200654
  Val   - Loss: 0.081278 | MSE: 0.081278 | RMSE: 0.285092 | MAE: 0.182455
============================================================
No improvement for 3 epochs

============================================================
Epoch 60/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 60 Summary:
  Train - Loss: 0.084677 | MSE: 0.084677 | RMSE: 0.290993 | MAE: 0.200617
  Val   - Loss: 0.072979 | MSE: 0.072979 | RMSE: 0.270146 | MAE: 0.177063
============================================================
No improvement for 4 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_60.pt

============================================================
Epoch 61/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 61 Summary:
  Train - Loss: 0.084387 | MSE: 0.084387 | RMSE: 0.290495 | MAE: 0.200401
  Val   - Loss: 0.076295 | MSE: 0.076295 | RMSE: 0.276216 | MAE: 0.182288
============================================================
No improvement for 5 epochs

============================================================
Epoch 62/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 62 Summary:
  Train - Loss: 0.084211 | MSE: 0.084211 | RMSE: 0.290191 | MAE: 0.200395
  Val   - Loss: 0.077431 | MSE: 0.077431 | RMSE: 0.278264 | MAE: 0.186512
============================================================
No improvement for 6 epochs

============================================================
Epoch 63/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 63 Summary:
  Train - Loss: 0.078141 | MSE: 0.078141 | RMSE: 0.279537 | MAE: 0.192439
  Val   - Loss: 0.068820 | MSE: 0.068820 | RMSE: 0.262335 | MAE: 0.168388
============================================================

✓ New best model saved! Val Loss: 0.068820

============================================================
Epoch 64/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 64 Summary:
  Train - Loss: 0.083665 | MSE: 0.083665 | RMSE: 0.289250 | MAE: 0.199457
  Val   - Loss: 0.072991 | MSE: 0.072991 | RMSE: 0.270169 | MAE: 0.174174
============================================================
No improvement for 1 epochs

============================================================
Epoch 65/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 65 Summary:
  Train - Loss: 0.083905 | MSE: 0.083905 | RMSE: 0.289664 | MAE: 0.199870
  Val   - Loss: 0.072462 | MSE: 0.072462 | RMSE: 0.269187 | MAE: 0.180510
============================================================
No improvement for 2 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_65.pt

============================================================
Epoch 66/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 66 Summary:
  Train - Loss: 0.083762 | MSE: 0.083762 | RMSE: 0.289416 | MAE: 0.199733
  Val   - Loss: 0.074671 | MSE: 0.074671 | RMSE: 0.273261 | MAE: 0.174994
============================================================
No improvement for 3 epochs

============================================================
Epoch 67/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 67 Summary:
  Train - Loss: 0.083445 | MSE: 0.083445 | RMSE: 0.288869 | MAE: 0.199522
  Val   - Loss: 0.073515 | MSE: 0.073515 | RMSE: 0.271136 | MAE: 0.183506
============================================================
No improvement for 4 epochs

============================================================
Epoch 68/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 68 Summary:
  Train - Loss: 0.083315 | MSE: 0.083315 | RMSE: 0.288643 | MAE: 0.199235
  Val   - Loss: 0.077539 | MSE: 0.077539 | RMSE: 0.278457 | MAE: 0.178438
============================================================
No improvement for 5 epochs

============================================================
Epoch 69/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 69 Summary:
  Train - Loss: 0.083077 | MSE: 0.083077 | RMSE: 0.288231 | MAE: 0.199033
  Val   - Loss: 0.073544 | MSE: 0.073544 | RMSE: 0.271189 | MAE: 0.176045
============================================================
No improvement for 6 epochs

============================================================
Epoch 70/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 70 Summary:
  Train - Loss: 0.077422 | MSE: 0.077422 | RMSE: 0.278247 | MAE: 0.191372
  Val   - Loss: 0.067259 | MSE: 0.067259 | RMSE: 0.259344 | MAE: 0.169536
============================================================

✓ New best model saved! Val Loss: 0.067259
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_70.pt

============================================================
Epoch 71/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 71 Summary:
  Train - Loss: 0.082755 | MSE: 0.082755 | RMSE: 0.287671 | MAE: 0.198515
  Val   - Loss: 0.073572 | MSE: 0.073572 | RMSE: 0.271242 | MAE: 0.176822
============================================================
No improvement for 1 epochs

============================================================
Epoch 72/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 72 Summary:
  Train - Loss: 0.082725 | MSE: 0.082725 | RMSE: 0.287619 | MAE: 0.198528
  Val   - Loss: 0.073014 | MSE: 0.073014 | RMSE: 0.270212 | MAE: 0.174064
============================================================
No improvement for 2 epochs

============================================================
Epoch 73/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 73 Summary:
  Train - Loss: 0.082645 | MSE: 0.082645 | RMSE: 0.287481 | MAE: 0.198307
  Val   - Loss: 0.072916 | MSE: 0.072916 | RMSE: 0.270030 | MAE: 0.182121
============================================================
No improvement for 3 epochs

============================================================
Epoch 74/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 74 Summary:
  Train - Loss: 0.082678 | MSE: 0.082678 | RMSE: 0.287538 | MAE: 0.198568
  Val   - Loss: 0.072165 | MSE: 0.072165 | RMSE: 0.268636 | MAE: 0.173583
============================================================
No improvement for 4 epochs

============================================================
Epoch 75/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 75 Summary:
  Train - Loss: 0.082814 | MSE: 0.082814 | RMSE: 0.287775 | MAE: 0.198550
  Val   - Loss: 0.075300 | MSE: 0.075300 | RMSE: 0.274408 | MAE: 0.176800
============================================================
No improvement for 5 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_75.pt

============================================================
Epoch 76/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 76 Summary:
  Train - Loss: 0.082619 | MSE: 0.082619 | RMSE: 0.287436 | MAE: 0.198298
  Val   - Loss: 0.072668 | MSE: 0.072668 | RMSE: 0.269571 | MAE: 0.177590
============================================================
No improvement for 6 epochs

============================================================
Epoch 77/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 77 Summary:
  Train - Loss: 0.076475 | MSE: 0.076475 | RMSE: 0.276541 | MAE: 0.190746
  Val   - Loss: 0.067434 | MSE: 0.067434 | RMSE: 0.259680 | MAE: 0.170287
============================================================
No improvement for 7 epochs

============================================================
Epoch 78/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 78 Summary:
  Train - Loss: 0.081641 | MSE: 0.081641 | RMSE: 0.285728 | MAE: 0.197285
  Val   - Loss: 0.073026 | MSE: 0.073026 | RMSE: 0.270232 | MAE: 0.183305
============================================================
No improvement for 8 epochs

============================================================
Epoch 79/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 79 Summary:
  Train - Loss: 0.082349 | MSE: 0.082349 | RMSE: 0.286966 | MAE: 0.197941
  Val   - Loss: 0.072317 | MSE: 0.072317 | RMSE: 0.268918 | MAE: 0.178125
============================================================
No improvement for 9 epochs

============================================================
Epoch 80/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 80 Summary:
  Train - Loss: 0.082319 | MSE: 0.082319 | RMSE: 0.286913 | MAE: 0.198008
  Val   - Loss: 0.072628 | MSE: 0.072628 | RMSE: 0.269495 | MAE: 0.174193
============================================================
No improvement for 10 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_80.pt

============================================================
Epoch 81/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 81 Summary:
  Train - Loss: 0.082138 | MSE: 0.082138 | RMSE: 0.286597 | MAE: 0.197789
  Val   - Loss: 0.073102 | MSE: 0.073102 | RMSE: 0.270374 | MAE: 0.178396
============================================================
No improvement for 11 epochs

============================================================
Epoch 82/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 82 Summary:
  Train - Loss: 0.082008 | MSE: 0.082008 | RMSE: 0.286370 | MAE: 0.197621
  Val   - Loss: 0.074256 | MSE: 0.074256 | RMSE: 0.272500 | MAE: 0.177056
============================================================
No improvement for 12 epochs

============================================================
Epoch 83/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 83 Summary:
  Train - Loss: 0.076156 | MSE: 0.076156 | RMSE: 0.275964 | MAE: 0.190188
  Val   - Loss: 0.066907 | MSE: 0.066907 | RMSE: 0.258663 | MAE: 0.172401
============================================================

✓ New best model saved! Val Loss: 0.066907

============================================================
Epoch 84/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 84 Summary:
  Train - Loss: 0.081910 | MSE: 0.081910 | RMSE: 0.286199 | MAE: 0.197100
  Val   - Loss: 0.073415 | MSE: 0.073415 | RMSE: 0.270952 | MAE: 0.179685
============================================================
No improvement for 1 epochs

============================================================
Epoch 85/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 85 Summary:
  Train - Loss: 0.081605 | MSE: 0.081605 | RMSE: 0.285666 | MAE: 0.197049
  Val   - Loss: 0.073122 | MSE: 0.073122 | RMSE: 0.270411 | MAE: 0.178396
============================================================
No improvement for 2 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_85.pt

============================================================
Epoch 86/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 86 Summary:
  Train - Loss: 0.081467 | MSE: 0.081467 | RMSE: 0.285423 | MAE: 0.197045
  Val   - Loss: 0.072125 | MSE: 0.072125 | RMSE: 0.268561 | MAE: 0.175573
============================================================
No improvement for 3 epochs

============================================================
Epoch 87/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 87 Summary:
  Train - Loss: 0.081324 | MSE: 0.081324 | RMSE: 0.285174 | MAE: 0.196872
  Val   - Loss: 0.071458 | MSE: 0.071458 | RMSE: 0.267315 | MAE: 0.172532
============================================================
No improvement for 4 epochs

============================================================
Epoch 88/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 88 Summary:
  Train - Loss: 0.081612 | MSE: 0.081612 | RMSE: 0.285679 | MAE: 0.197079
  Val   - Loss: 0.071151 | MSE: 0.071151 | RMSE: 0.266742 | MAE: 0.172191
============================================================
No improvement for 5 epochs

============================================================
Epoch 89/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 89 Summary:
  Train - Loss: 0.081026 | MSE: 0.081026 | RMSE: 0.284650 | MAE: 0.196694
  Val   - Loss: 0.073982 | MSE: 0.073982 | RMSE: 0.271996 | MAE: 0.175187
============================================================
No improvement for 6 epochs

============================================================
Epoch 90/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 90 Summary:
  Train - Loss: 0.075666 | MSE: 0.075666 | RMSE: 0.275074 | MAE: 0.189337
  Val   - Loss: 0.066880 | MSE: 0.066880 | RMSE: 0.258612 | MAE: 0.165432
============================================================

✓ New best model saved! Val Loss: 0.066880
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_90.pt

============================================================
Epoch 91/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 91 Summary:
  Train - Loss: 0.080778 | MSE: 0.080778 | RMSE: 0.284214 | MAE: 0.196104
  Val   - Loss: 0.074724 | MSE: 0.074724 | RMSE: 0.273356 | MAE: 0.182611
============================================================
No improvement for 1 epochs

============================================================
Epoch 92/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 92 Summary:
  Train - Loss: 0.081287 | MSE: 0.081287 | RMSE: 0.285109 | MAE: 0.196815
  Val   - Loss: 0.069794 | MSE: 0.069794 | RMSE: 0.264186 | MAE: 0.172848
============================================================
No improvement for 2 epochs

============================================================
Epoch 93/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 93 Summary:
  Train - Loss: 0.080890 | MSE: 0.080890 | RMSE: 0.284412 | MAE: 0.196497
  Val   - Loss: 0.070375 | MSE: 0.070375 | RMSE: 0.265282 | MAE: 0.174085
============================================================
No improvement for 3 epochs

============================================================
Epoch 94/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 94 Summary:
  Train - Loss: 0.080751 | MSE: 0.080751 | RMSE: 0.284168 | MAE: 0.196311
  Val   - Loss: 0.073757 | MSE: 0.073757 | RMSE: 0.271583 | MAE: 0.184692
============================================================
No improvement for 4 epochs

============================================================
Epoch 95/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 95 Summary:
  Train - Loss: 0.080477 | MSE: 0.080477 | RMSE: 0.283685 | MAE: 0.196249
  Val   - Loss: 0.074065 | MSE: 0.074065 | RMSE: 0.272149 | MAE: 0.181140
============================================================
No improvement for 5 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_95.pt

============================================================
Epoch 96/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 96 Summary:
  Train - Loss: 0.080630 | MSE: 0.080630 | RMSE: 0.283954 | MAE: 0.195947
  Val   - Loss: 0.072235 | MSE: 0.072235 | RMSE: 0.268765 | MAE: 0.174503
============================================================
No improvement for 6 epochs

============================================================
Epoch 97/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 97 Summary:
  Train - Loss: 0.074711 | MSE: 0.074711 | RMSE: 0.273333 | MAE: 0.188513
  Val   - Loss: 0.067219 | MSE: 0.067219 | RMSE: 0.259266 | MAE: 0.166881
============================================================
No improvement for 7 epochs

============================================================
Epoch 98/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 98 Summary:
  Train - Loss: 0.080475 | MSE: 0.080475 | RMSE: 0.283682 | MAE: 0.195537
  Val   - Loss: 0.070916 | MSE: 0.070916 | RMSE: 0.266301 | MAE: 0.178102
============================================================
No improvement for 8 epochs

============================================================
Epoch 99/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 99 Summary:
  Train - Loss: 0.080090 | MSE: 0.080090 | RMSE: 0.283002 | MAE: 0.195403
  Val   - Loss: 0.072043 | MSE: 0.072043 | RMSE: 0.268408 | MAE: 0.171040
============================================================
No improvement for 9 epochs

============================================================
Epoch 100/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 100 Summary:
  Train - Loss: 0.080103 | MSE: 0.080103 | RMSE: 0.283025 | MAE: 0.195538
  Val   - Loss: 0.076063 | MSE: 0.076063 | RMSE: 0.275794 | MAE: 0.179845
============================================================
No improvement for 10 epochs
Checkpoint saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_epoch_100.pt

============================================================
Epoch 101/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 101 Summary:
  Train - Loss: 0.080043 | MSE: 0.080043 | RMSE: 0.282918 | MAE: 0.195377
  Val   - Loss: 0.070581 | MSE: 0.070581 | RMSE: 0.265671 | MAE: 0.176108
============================================================
No improvement for 11 epochs

============================================================
Epoch 102/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 102 Summary:
  Train - Loss: 0.079726 | MSE: 0.079726 | RMSE: 0.282358 | MAE: 0.195290
  Val   - Loss: 0.069453 | MSE: 0.069453 | RMSE: 0.263538 | MAE: 0.170768
============================================================
No improvement for 12 epochs

============================================================
Epoch 103/150
Learning Rate: 5.00e-04
============================================================

============================================================
Epoch 103 Summary:
  Train - Loss: 0.074789 | MSE: 0.074789 | RMSE: 0.273476 | MAE: 0.188169
  Val   - Loss: 0.068697 | MSE: 0.068697 | RMSE: 0.262102 | MAE: 0.170984
============================================================
No improvement for 13 epochs

============================================================
Epoch 104/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 104 Summary:
  Train - Loss: 0.079589 | MSE: 0.079589 | RMSE: 0.282116 | MAE: 0.194622
  Val   - Loss: 0.069716 | MSE: 0.069716 | RMSE: 0.264038 | MAE: 0.168388
============================================================
No improvement for 14 epochs

============================================================
Epoch 105/150
Learning Rate: 1.00e-03
============================================================

============================================================
Epoch 105 Summary:
  Train - Loss: 0.079773 | MSE: 0.079773 | RMSE: 0.282441 | MAE: 0.194963
  Val   - Loss: 0.069731 | MSE: 0.069731 | RMSE: 0.264067 | MAE: 0.171487
============================================================
No improvement for 15 epochs

Early stopping triggered after 15 epochs without improvement
Best validation loss: 0.066880

Final model saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/model_final.pt
Training history saved: src/trained_weights/UMambaMag_v2_STEAD_20251109_135511/training_history_20251109_135511.pt

============================================================
TRAINING COMPLETED
============================================================
Best validation loss: 0.066880
Best validation RMSE: 0.258612
Final train loss: 0.079773
Final val loss: 0.069731
Total Training Time: 27:38:03
============================================================
==================================================

